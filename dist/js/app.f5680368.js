(function(e){function t(t){for(var a,l,o=t[0],r=t[1],j=t[2],d=0,b=[];d<o.length;d++)l=o[d],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&b.push(n[l][0]),n[l]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);O&&O(t);while(b.length)b.shift()();return s.push.apply(s,j||[]),c()}function c(){for(var e,t=0;t<s.length;t++){for(var c=s[t],a=!0,l=1;l<c.length;l++){var o=c[l];0!==n[o]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=c[0]))}return e}var a={},l={app:0},n={app:0},s=[];function o(e){return r.p+"./js/"+({}[e]||e)+"."+{"chunk-2d0e95df":"3c818699","chunk-30779b1a":"9b644f0c","chunk-7915fb20":"948205ad"}[e]+".js"}function r(t){if(a[t])return a[t].exports;var c=a[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,r),c.l=!0,c.exports}r.e=function(e){var t=[],c={"chunk-30779b1a":1,"chunk-7915fb20":1};l[e]?t.push(l[e]):0!==l[e]&&c[e]&&t.push(l[e]=new Promise((function(t,c){for(var a="css/"+({}[e]||e)+"."+{"chunk-2d0e95df":"31d6cfe0","chunk-30779b1a":"ead5d3ab","chunk-7915fb20":"5fd2e640"}[e]+".css",n=r.p+a,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var j=s[o],d=j.getAttribute("data-href")||j.getAttribute("href");if("stylesheet"===j.rel&&(d===a||d===n))return t()}var b=document.getElementsByTagName("style");for(o=0;o<b.length;o++){j=b[o],d=j.getAttribute("data-href");if(d===a||d===n)return t()}var O=document.createElement("link");O.rel="stylesheet",O.type="text/css",O.onload=t,O.onerror=function(t){var a=t&&t.target&&t.target.src||n,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete l[e],O.parentNode.removeChild(O),c(s)},O.href=n;var N=document.getElementsByTagName("head")[0];N.appendChild(O)})).then((function(){l[e]=0})));var a=n[e];if(0!==a)if(a)t.push(a[2]);else{var s=new Promise((function(t,c){a=n[e]=[t,c]}));t.push(a[2]=s);var j,d=document.createElement("script");d.charset="utf-8",d.timeout=120,r.nc&&d.setAttribute("nonce",r.nc),d.src=o(e);var b=new Error;j=function(t){d.onerror=d.onload=null,clearTimeout(O);var c=n[e];if(0!==c){if(c){var a=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;b.message="Loading chunk "+e+" failed.\n("+a+": "+l+")",b.name="ChunkLoadError",b.type=a,b.request=l,c[1](b)}n[e]=void 0}};var O=setTimeout((function(){j({type:"timeout",target:d})}),12e4);d.onerror=d.onload=j,document.head.appendChild(d)}return Promise.all(t)},r.m=e,r.c=a,r.d=function(e,t,c){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(r.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(c,a,function(t){return e[t]}.bind(null,a));return c},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://sunny586.github.io/dist/",r.oe=function(e){throw e};var j=window["webpackJsonp"]=window["webpackJsonp"]||[],d=j.push.bind(j);j.push=t,j=j.slice();for(var b=0;b<j.length;b++)t(j[b]);var O=d;s.push([0,"chunk-libs"]),c()})({0:function(e,t,c){e.exports=c("cd49")},"1aae":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"curry add"),Object(a["createElementVNode"])("h2",null,"题目"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("写一个 "),Object(a["createElementVNode"])("code",null,"curry"),Object(a["createTextVNode"])(" 函数，可以把其他函数转为 curry 函数")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"add"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b, c"),Object(a["createTextVNode"])(") { "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" a + b + c }\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"add"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 6"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" curryAdd = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"curry"),Object(a["createTextVNode"])("(add)\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"curryAdd"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(")("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(")("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 6"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"解答"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"curry"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("fn: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"Function")]),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fnArgsLength = fn."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 传入函数的参数长度"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"let"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"args"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ts 中，独立的函数，this 需要声明类型"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"calc"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", ...newArgs: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 积累参数"),Object(a["createTextVNode"])("\n        args = [\n            ...args,\n            ...newArgs\n        ]\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (args."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" < fnArgsLength) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 参数不够，返回函数"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" calc\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 参数够了，返回执行结果"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" fn."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"apply"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(", args."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"slice"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(", fnArgsLength))\n        }\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" calc\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// function add(a: number, b: number, c: number): number {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     return a + b + c"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // add(10, 20, 30) // 60"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const curryAdd = curry(add)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const res = curryAdd(10)(20)(30) // 60"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(res)"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"总结"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"判断参数长度"),Object(a["createElementVNode"])("li",null,"中间态返回函数，最后返回执行结果"),Object(a["createElementVNode"])("li",null,"如用 this 慎用箭头函数")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"27d4":function(e,t,c){"use strict";c("c680")},"2eb0":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"Array flatten"),Object(a["createElementVNode"])("h2",null,"问题"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("写一个函数，实现 Array flatten 扁平化，只减少一个嵌套层级"),Object(a["createElementVNode"])("br"),Object(a["createTextVNode"])(" 例如输入 "),Object(a["createElementVNode"])("code",null,"[1, 2, [3, 4, [100, 200], 5], 6]"),Object(a["createTextVNode"])(" 返回 "),Object(a["createElementVNode"])("code",null,"[1, 2, 3, 4, [100, 200], 5, 6]")]),Object(a["createElementVNode"])("h2",null,"解答"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"遍历数组"),Object(a["createElementVNode"])("li",null,"如果 item 是数字，则累加"),Object(a["createElementVNode"])("li",null,"如果 item 是数组，则 forEach 累加其元素")]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 数组扁平化，使用 push\n * @param arr arr\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flatten1"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("arr: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"res"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []\n\n    arr."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"isArray"),Object(a["createTextVNode"])("(item)) {\n            item."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"n"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(n))\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(item)\n        }\n    })\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 数组扁平化，使用 concat\n * @param arr arr\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flatten2"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("arr: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"let"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"res"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []\n\n    arr."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n        res = res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"concat"),Object(a["createTextVNode"])("(item)\n    })\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const arr = [1, [2, [3], 4], 5]"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( flatten2(arr) )"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("h2",null,"连环问：如果想要彻底扁平，忽略所有嵌套层级？"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("像 lodash "),Object(a["createElementVNode"])("a",{href:"https://www.lodashjs.com/docs/lodash.flattenDepth"},"flattenDepth"),Object(a["createTextVNode"])(" ，例如输入 "),Object(a["createElementVNode"])("code",null,"[1, 2, [3, 4, [100, 200], 5], 6]"),Object(a["createTextVNode"])(" 返回 "),Object(a["createElementVNode"])("code",null,"[1, 2, 3, 4, 100, 200, 5, 6]")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("最容易想到的解决方案就是"),Object(a["createElementVNode"])("strong",null,"递归"),Object(a["createTextVNode"])("，代码参考")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 数组深度扁平化，使用 push\n * @param arr arr\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flattenDeep1"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("arr: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"res"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []\n\n    arr."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"isArray"),Object(a["createTextVNode"])("(item)) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" flatItem = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flattenDeep1"),Object(a["createTextVNode"])("(item) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 递归"),Object(a["createTextVNode"])("\n            flatItem."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"n"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(n))\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(item)\n        }\n    })\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 数组深度扁平化，使用 concat\n * @param arr arr\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flattenDeep2"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("arr: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"let"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"res"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []\n\n    arr."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"isArray"),Object(a["createTextVNode"])("(item)) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" flatItem = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"flattenDeep2"),Object(a["createTextVNode"])("(item) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 递归"),Object(a["createTextVNode"])("\n            res = res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"concat"),Object(a["createTextVNode"])("(flatItem)\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            res = res."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"concat"),Object(a["createTextVNode"])("(item)\n        }\n    })\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const arr = [1, [2, [3, ['a', [true], 'b'], 4], 5], 6]"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( flattenDeep2(arr) )"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("还有一种 hack 的方式 "),Object(a["createElementVNode"])("code",null,"toString"),Object(a["createTextVNode"])(" —— 但遇到引用类型的 item 就不行了。")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" nums = ["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(", ["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"4"),Object(a["createTextVNode"])(", ["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"200"),Object(a["createTextVNode"])("], "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"5"),Object(a["createTextVNode"])("], "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"6"),Object(a["createTextVNode"])("]\nnums."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"toString"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '1,2,3,4,100,200,5,6'"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 但万一数组元素是 {x: 100} 等引用类型，就不可以了"),Object(a["createTextVNode"])("\n")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"3e8b":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"DOM 转 VDOM"),Object(a["createElementVNode"])("h2",null,"问题"),Object(a["createElementVNode"])("p",null,"讲以下 DOM 结构转换为 vnode 数据"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-html"},[Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"div"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"id"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"div1"'),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"style"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"border: 1px solid #ccc; padding: 10px;"'),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"p"),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("一行文字"),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"a"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"href"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"xxx.html"'),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"target"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"_blank"'),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("链接"),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("</"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"a"),Object(a["createTextVNode"])(">")]),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("</"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"p"),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"img"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"src"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"xxx.png"'),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"alt"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"图片"'),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"class"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"image"'),Object(a["createTextVNode"])("/>")]),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"button"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"click"),Object(a["createTextVNode"])("="),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"clickHandler"'),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("点击"),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("</"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"button"),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-tag"},[Object(a["createTextVNode"])("</"),Object(a["createElementVNode"])("span",{class:"hljs-name"},"div"),Object(a["createTextVNode"])(">")]),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"答案"),Object(a["createElementVNode"])("p",null,"vdom 就是用 JS 对象的形式来表示 DOM 结构。vnode 即对应着 DOM 结构的一个 node 节点。"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" vnode = {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tag"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'div'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// <div>"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"id"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'div1'"),Object(a["createTextVNode"])(",\n        "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"style"),Object(a["createTextVNode"])(": {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'border'"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'1px solid #ccc'"),Object(a["createTextVNode"])(",\n            "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'padding'"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'10px'"),Object(a["createTextVNode"])("\n        }\n    },\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"children"),Object(a["createTextVNode"])(": [\n        {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tag"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'p'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// <p>"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {},\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"children"),Object(a["createTextVNode"])(": [\n                "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'一行文字'"),Object(a["createTextVNode"])(",\n                {\n                    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tag"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'a'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// <a>"),Object(a["createTextVNode"])("\n                    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {\n                        "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"href"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx.html'"),Object(a["createTextVNode"])(",\n                        "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"target"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'_blank'"),Object(a["createTextVNode"])("\n                    },\n                    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"children"),Object(a["createTextVNode"])(": ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'链接'"),Object(a["createTextVNode"])("]\n                }\n            ]\n        },\n        {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tag"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'img'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// <img>"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"className"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'image'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注意，这里要用 className"),Object(a["createTextVNode"])("\n                "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"src"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx.png'"),Object(a["createTextVNode"])(",\n                "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"alt"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'图片'"),Object(a["createTextVNode"])("\n            }\n        },\n        {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tag"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'button'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// <button>"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"events"),Object(a["createTextVNode"])(": {\n                    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"click"),Object(a["createTextVNode"])(": clickHandler\n                }\n            }\n            "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"children"),Object(a["createTextVNode"])(": ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'点击'"),Object(a["createTextVNode"])("]\n        }\n    ]\n}\n")])]),Object(a["createElementVNode"])("h2",null,"注意事项"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("vdom 结构没有固定的标准，例如 "),Object(a["createElementVNode"])("code",null,"tag"),Object(a["createTextVNode"])(" 可以改为 "),Object(a["createElementVNode"])("code",null,"name"),Object(a["createTextVNode"])(" ，"),Object(a["createElementVNode"])("code",null,"data"),Object(a["createTextVNode"])(" 可以改为 "),Object(a["createElementVNode"])("code",null,"props"),Object(a["createTextVNode"])(" 。只要能合理使用 JS 数据表达 DOM 即可。")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"style"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"events"),Object(a["createTextVNode"])(" 要以对象的形式，更易读，更易扩展")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"class"),Object(a["createTextVNode"])(" 是 ES 内置关键字，要改为 "),Object(a["createElementVNode"])("code",null,"className"),Object(a["createTextVNode"])(" 。其他的还有如 "),Object(a["createElementVNode"])("code",null,"for"),Object(a["createTextVNode"])(" 改为 "),Object(a["createElementVNode"])("code",null,"htmlFor")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"53f6":function(e,t,c){},"54af":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"类型判断"),Object(a["createElementVNode"])("h2",null,"问题"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("实现一个 "),Object(a["createElementVNode"])("code",null,"getType"),Object(a["createTextVNode"])(" 函数，传入一个变量，能准确的获取它的类型。 如 "),Object(a["createElementVNode"])("code",null,"number"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"string"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"object"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"array"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"map"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"regexp"),Object(a["createTextVNode"])(" 等。")]),Object(a["createElementVNode"])("h2",null,"类型判断"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("常规的类型判断一般用 "),Object(a["createElementVNode"])("code",null,"typeof"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"instanceof"),Object(a["createTextVNode"])(" ，但这俩也有一些缺点")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"typeof"),Object(a["createTextVNode"])(" 无法继续区分 "),Object(a["createElementVNode"])("code",null,"object"),Object(a["createTextVNode"])(" 类型")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"instanceof"),Object(a["createTextVNode"])(" 需要知道构造函数，即需要两个输入")])]),Object(a["createElementVNode"])("h2",null,"枚举不是好方法"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("你可能觉得 "),Object(a["createElementVNode"])("code",null,"typeof"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"instanceof"),Object(a["createTextVNode"])(" 结合起来可以判断，枚举所有的类型。"),Object(a["createElementVNode"])("br"),Object(a["createTextVNode"])(" 这并不是一个好方法，因为"),Object(a["createElementVNode"])("strong",null,"手动枚举是不靠谱的"),Object(a["createTextVNode"])("，不具备完整性。"),Object(a["createElementVNode"])("br"),Object(a["createTextVNode"])(" 第一，你有可能忽略某些类型，如；第二，ES 有会继续增加新的类型，如 "),Object(a["createElementVNode"])("code",null,"Symbol"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"BigInt")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getType"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("x: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" x === "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'object'"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"isArray"),Object(a["createTextVNode"])("(x)) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'array'"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (x instance "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"of"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'map'"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 继续枚举..."),Object(a["createTextVNode"])("\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" x\n}\n")])]),Object(a["createElementVNode"])("h2",null,[Object(a["createTextVNode"])("使用 "),Object(a["createElementVNode"])("code",null,"Object.prototype.toString")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("注意，必须用 "),Object(a["createElementVNode"])("code",null,"Object.prototype.toString"),Object(a["createTextVNode"])(" ，不可以直接用 "),Object(a["createElementVNode"])("code",null,"toString"),Object(a["createTextVNode"])("。后者可能是子类重写的。")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])("]."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"toString"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '1,2' （ 这样使用的其实是 Array.prototype.toString ）"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"toString"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"call"),Object(a["createTextVNode"])("(["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])("]) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '[object Array]'"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 获取详细的数据类型\n * @param x x\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getType"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("x: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" originType = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"toString"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"call"),Object(a["createTextVNode"])("(x) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '[object String]'"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" spaceIndex = originType."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"indexOf"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"' '"),Object(a["createTextVNode"])(")\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(" = originType."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"slice"),Object(a["createTextVNode"])("(spaceIndex + "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", -"),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 'String'"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"toLowerCase"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 'string'"),Object(a["createTextVNode"])("\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(null) ) // 'null'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(undefined) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(100) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType('abc') )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(true) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(Symbol()) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType({}) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType([]) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( getType(() => {}) )"),Object(a["createTextVNode"])("\n\n")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"696e":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写 instanceof"),Object(a["createElementVNode"])("h2",null,"问题"),Object(a["createElementVNode"])("p",null,"instanceof 的原理是什么，请用代码来表示"),Object(a["createElementVNode"])("h2",null,"原型链"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%89%8B%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/img/%E5%8E%9F%E5%9E%8B%E9%93%BE.png",alt:""})]),Object(a["createElementVNode"])("h2",null,"instanceof 原理"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("例如 "),Object(a["createElementVNode"])("code",null,"a instanceof b"),Object(a["createTextVNode"])(" 就是：顺着 "),Object(a["createElementVNode"])("code",null,"a"),Object(a["createTextVNode"])(" 的 "),Object(a["createElementVNode"])("code",null,"__proto__"),Object(a["createTextVNode"])(" 链向上找，能否找到 "),Object(a["createElementVNode"])("code",null,"b.prototype")]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 自定义 instanceof\n * @param instance instance\n * @param origin class or function\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"myInstanceof"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("instance: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", origin: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"boolean"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (instance == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"false"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// null undefined"),Object(a["createTextVNode"])("\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" instance\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(" !== "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'object'"),Object(a["createTextVNode"])(" && "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(" !== "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'function'"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 值类型"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"false"),Object(a["createTextVNode"])("\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"let"),Object(a["createTextVNode"])(" tempInstance = instance "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 为了防止修改 instance"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"while"),Object(a["createTextVNode"])(" (tempInstance) {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (tempInstance."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"__proto__"),Object(a["createTextVNode"])(" === origin."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])(") {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"true"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 配上了"),Object(a["createTextVNode"])("\n        }\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 未匹配"),Object(a["createTextVNode"])("\n        tempInstance = tempInstance."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"__proto__"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 顺着原型链，往上找"),Object(a["createTextVNode"])("\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"false"),Object(a["createTextVNode"])("\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( myInstanceof({}, Object) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( myInstanceof([], Object) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( myInstanceof([], Array) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( myInstanceof({}, Array) )"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info( myInstanceof('abc', String) )"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("h2",null,"总结"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"原型链"),Object(a["createElementVNode"])("li",null,"循环判断")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"69e2":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"遍历 DOM 树"),Object(a["createElementVNode"])("h2",null,"题目"),Object(a["createElementVNode"])("p",null,"写一个函数遍历 DOM 树，分别用深度优先和广度优先"),Object(a["createElementVNode"])("p",null,"PS：注意回顾 “Node 和 Element 和区别”"),Object(a["createElementVNode"])("h2",null,"深度优先 vs 广度优先"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%89%8B%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/img/dom-tree.png",alt:""})]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("深度优先的结果 "),Object(a["createElementVNode"])("code",null,'<div> <p> "hello" <b> "world" <img> 注释 <ul> <li> "a" <li> "b"')]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("广度优先的结果 "),Object(a["createElementVNode"])("code",null,'<div> <p> <img> 注释 <ul> "hello" <b> <li> <li> "world" "a" "b"')]),Object(a["createElementVNode"])("h2",null,"深度优先"),Object(a["createElementVNode"])("p",null,"一般通过递归实现"),Object(a["createElementVNode"])("h2",null,"广度优先"),Object(a["createElementVNode"])("p",null,"一般通过队列实现"),Object(a["createElementVNode"])("h2",null,"解答"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"深度优先，递归"),Object(a["createElementVNode"])("li",null,"广度优先，队列")]),Object(a["createElementVNode"])("h2",null,"连环问：深度优先可以不用递归吗？"),Object(a["createElementVNode"])("p",null,"深度优先遍历，可以使用栈代替递归，递归本质上就是栈。"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 访问节点\n * @param n node\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"visitNode"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"n: Node"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (n "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Comment"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注释"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'Comment node ---'"),Object(a["createTextVNode"])(", n."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"textContent"),Object(a["createTextVNode"])(")\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (n "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Text"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 文本"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" t = n."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"textContent"),Object(a["createTextVNode"])("?."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"trim"),Object(a["createTextVNode"])("()\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (t) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'Text node ---'"),Object(a["createTextVNode"])(", t)\n        }\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (n "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"HTMLElement"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// element"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'Element node ---'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},[Object(a["createTextVNode"])("`<"),Object(a["createElementVNode"])("span",{class:"hljs-subst"},"${n.tagName.toLowerCase()}"),Object(a["createTextVNode"])(">`")]),Object(a["createTextVNode"])(")\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 深度优先遍历\n * @param root dom node\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"depthFirstTraverse1"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"root: Node"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"visitNode"),Object(a["createTextVNode"])("(root)\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" childNodes = root."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"childNodes"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// .childNodes 和 .children 不一样"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (childNodes."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(") {\n        childNodes."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"child"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"depthFirstTraverse1"),Object(a["createTextVNode"])("(child) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 递归"),Object(a["createTextVNode"])("\n        })\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 深度优先遍历\n * @param root dom node\n */"),Object(a["createTextVNode"])("\n "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"depthFirstTraverse2"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"root: Node"),Object(a["createTextVNode"])(") {\n     "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"stack"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Node"),Object(a["createTextVNode"])("[] = []\n\n     "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 根节点压栈"),Object(a["createTextVNode"])("\n     stack."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(root)\n\n     "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"while"),Object(a["createTextVNode"])(" (stack."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" > "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n         "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" curNode = stack."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"pop"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 出栈"),Object(a["createTextVNode"])("\n         "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (curNode == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"break"),Object(a["createTextVNode"])("\n\n         "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"visitNode"),Object(a["createTextVNode"])("(curNode)\n\n         "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 子节点压栈"),Object(a["createTextVNode"])("\n         "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" childNodes = curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"childNodes"),Object(a["createTextVNode"])("\n         "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (childNodes."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" > "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n             "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// reverse 反顺序压栈"),Object(a["createTextVNode"])("\n             "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"from"),Object(a["createTextVNode"])("(childNodes)."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"reverse"),Object(a["createTextVNode"])("()."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"child"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" stack."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(child))\n         }\n     }\n }\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 广度优先遍历\n * @param root dom node\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"breadthFirstTraverse"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"root: Node"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"queue"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Node"),Object(a["createTextVNode"])("[] = [] "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 数组 vs 链表"),Object(a["createTextVNode"])("\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 根节点入队列"),Object(a["createTextVNode"])("\n    queue."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"unshift"),Object(a["createTextVNode"])("(root)\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"while"),Object(a["createTextVNode"])(" (queue."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" > "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" curNode = queue."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"pop"),Object(a["createTextVNode"])("()\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (curNode == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"break"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"visitNode"),Object(a["createTextVNode"])("(curNode)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 子节点入队"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" childNodes = curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"childNodes"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (childNodes."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(") {\n            childNodes."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"child"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" queue."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"unshift"),Object(a["createTextVNode"])("(child))\n        }\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" box = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getElementById"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'box'"),Object(a["createTextVNode"])(")\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (box == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"throw"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'box is null'"),Object(a["createTextVNode"])(")\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"depthFirstTraverse2"),Object(a["createTextVNode"])("(box)\n\n")])]),Object(a["createElementVNode"])("p",null,"递归和非递归哪个更好？"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("递归逻辑更加清晰，但容易出现 "),Object(a["createElementVNode"])("code",null,"stack overflow"),Object(a["createTextVNode"])(" 错误（可使用"),Object(a["createElementVNode"])("code",null,"尾递归"),Object(a["createTextVNode"])("，编译器有优化）")]),Object(a["createElementVNode"])("li",null,"非递归效率更高，但使用栈，逻辑稍微复杂一些")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"6df7":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写 EventBus"),Object(a["createElementVNode"])("p",null,"Bus 不是“车”，而是“总线”"),Object(a["createElementVNode"])("h2",null,"问题"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("请手写 EventBus 自定义事件，实现 "),Object(a["createElementVNode"])("code",null,"no"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"once"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"emit"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"off")]),Object(a["createElementVNode"])("h2",null,"EventBus 功能"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" event = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"EventBus"),Object(a["createTextVNode"])("()\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn1"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b"),Object(a["createTextVNode"])(") { "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'fn1'"),Object(a["createTextVNode"])(", a, b) }\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn2"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b"),Object(a["createTextVNode"])(") { "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'fn2'"),Object(a["createTextVNode"])(", a, b) }\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn3"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b"),Object(a["createTextVNode"])(") { "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'fn3'"),Object(a["createTextVNode"])(", a, b) }\n\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"on"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", fn1)\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"on"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", fn2)\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"once"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", fn3)\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"on"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxxxxx'"),Object(a["createTextVNode"])(", fn3)\n\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"emit"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 触发 fn1 fn2 fn3"),Object(a["createTextVNode"])("\n\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"off"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", fn1)\n\nevent."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"emit"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'key1'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"200"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 触发 fn2"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"实现"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"class"),Object(a["createTextVNode"])(" 结构")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("注意区分 "),Object(a["createElementVNode"])("code",null,"on"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"off")])]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"EventBus"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n     * {\n     *    'key1': [\n     *        { fn: fn1, isOnce: false },\n     *        { fn: fn2, isOnce: false },\n     *        { fn: fn3, isOnce: true },\n     *    ]\n     *    'key2': [] // 有序\n     *    'key3': []\n     * }\n     */"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"events"),Object(a["createTextVNode"])(": {\n        ["),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("]: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])("<{"),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"fn"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])("; "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"isOnce"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"boolean"),Object(a["createTextVNode"])("}>\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])(" = {}\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"on"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(", fn: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"Function"),Object(a["createTextVNode"])(", isOnce: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"boolean"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"false")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" events = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (events["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("] == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") {\n            events["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("] = [] "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 初始化 key 的 fn 数组"),Object(a["createTextVNode"])("\n        }\n        events["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("]."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("({ fn, isOnce })\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"once"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(", fn: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"Function")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"on"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(", fn, "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"true"),Object(a["createTextVNode"])(")\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"off"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(", fn?: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"Function")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (!fn) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 解绑所有 type 的函数"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("] = []\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 解绑单个 fn"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fnList = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("]\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (fnList) {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("] = fnList."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"filter"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" item."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"fn"),Object(a["createTextVNode"])(" !== fn)\n            }\n        }\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"emit"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(", ...args: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fnList = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("]\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (fnList == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注意"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"events"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])("] = fnList."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"filter"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" { fn, isOnce } = item\n            "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn"),Object(a["createTextVNode"])("(...args)\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// once 执行一次就要被过滤掉"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (!isOnce) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"true"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"false"),Object(a["createTextVNode"])("\n        })\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const e = new EventBus()"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// function fn1(a: any, b: any) { console.log('fn1', a, b) }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// function fn2(a: any, b: any) { console.log('fn2', a, b) }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// function fn3(a: any, b: any) { console.log('fn3', a, b) }"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.on('key1', fn1)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.on('key1', fn2)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.once('key1', fn3)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.on('xxxxxx', fn3)"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.emit('key1', 10, 20) // 触发 fn1 fn2 fn3"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.off('key1', fn1)"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// e.emit('key1', 100, 200) // 触发 fn2"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("h2",null,"连环问：EventBus 里的数组可以换成 Set 吗？"),Object(a["createElementVNode"])("p",null,"数组和 Set 比较 （除了语法 API）"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"数组，有序结构，查找、中间插入、中间删除比较慢"),Object(a["createElementVNode"])("li",null,"Set 不可排序的，插入和删除都很快")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("Set 初始化或者 "),Object(a["createElementVNode"])("code",null,"add"),Object(a["createTextVNode"])(" 时是一个有序结构，但它无法再次排序，没有 "),Object(a["createElementVNode"])("code",null,"index"),Object(a["createTextVNode"])(" 也没有 "),Object(a["createElementVNode"])("code",null,"sort"),Object(a["createTextVNode"])(" 等 API")]),Object(a["createElementVNode"])("p",null,"验证"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("生成一个大数组，验证 "),Object(a["createElementVNode"])("code",null,"push"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"unshift"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"includes"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"splice")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("生成一个大 Set ，验证 "),Object(a["createElementVNode"])("code",null,"add"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"delete"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"has")])]),Object(a["createElementVNode"])("p",null,"答案：不可以，Set 是不可排序的，如再增加一些“权重”之类的需求，将不好实现。"),Object(a["createElementVNode"])("h2",null,"Map 和 Object"),Object(a["createElementVNode"])("p",null,"Object 是无序的"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data1 = {"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'1'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'aaa'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'2'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'bbb'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'3'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'ccc'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'测试'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'000'"),Object(a["createTextVNode"])("}\n"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"keys"),Object(a["createTextVNode"])("(data1) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},'// ["1", "2", "3", "测试"]'),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data2 = {"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'测试'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'000'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'1'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'aaa'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'3'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'ccc'"),Object(a["createTextVNode"])(","),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'2'"),Object(a["createTextVNode"])(":"),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'bbb'"),Object(a["createTextVNode"])("};\n"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"keys"),Object(a["createTextVNode"])("(data2); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},'// ["1", "2", "3", "测试"]'),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("p",null,"Map 是有序的"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" m1 = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])("([\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'1'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'aaa'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'2'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'bbb'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'3'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'ccc'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'测试'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'000'"),Object(a["createTextVNode"])("]\n])\nm1."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"val, key"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" { "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("(key, val) })\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" m2 = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])("([\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'测试'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'000'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'1'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'aaa'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'3'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'ccc'"),Object(a["createTextVNode"])("],\n    ["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'2'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'bbb'"),Object(a["createTextVNode"])("]\n])\nm2."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"val, key"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" { "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("(key, val) })\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("另外，"),Object(a["createElementVNode"])("strong",null,[Object(a["createTextVNode"])("Map 虽然是有序的，但它的 "),Object(a["createElementVNode"])("code",null,"get"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"set"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"delete"),Object(a["createTextVNode"])(" 速度非常快")]),Object(a["createTextVNode"])("，和 Object 效率一样。它是被优化过的有序结构。")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"6f73":function(e,t,c){"use strict";c("80bb")},"7cb0":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"hybrid 是什么，为什么会用到 hybrid"),Object(a["createElementVNode"])("h2",null,"文字解释"),Object(a["createElementVNode"])("p",null,"hybrid 即混合开发，是一种客户端、h5结合来开发才能做出的效果，这里其中甚至还涉及到 server 端的知识。"),Object(a["createElementVNode"])("p",null,"截图（左侧头条列表，右侧头条新闻详情页）"),Object(a["createElementVNode"])("p",null,"头条的新闻详情页，很有可能就是用的 hybrid 实现的（我不在头条工作我不知道，但是我知道一个类似头条的 app ，新闻详情页就是用 hybrid 实现的）"),Object(a["createElementVNode"])("h2",null,"存在价值"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"可以快速迭代更新【关键】（而 app 发版需要经过漫长的审核等待时间）—— 思考：为何 app 需要审核，而 hybrid 无需审核？？？"),Object(a["createElementVNode"])("li",null,"体验流畅（和 NA 的体验基本类似）"),Object(a["createElementVNode"])("li",null,"减少开发和沟通成本，公用一套代码")]),Object(a["createElementVNode"])("h2",null,"webview"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"是 app 中的一个组件（ app 中可以有 webview ，也可以没有）"),Object(a["createElementVNode"])("li",null,"用于加载 h5 页面，即一个小型的浏览器内核")]),Object(a["createElementVNode"])("p",null,"截图举例："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"例1：UC 浏览器（首页、访问网址）"),Object(a["createElementVNode"])("li",null,"例2：微信（朋友圈页，内容页）")]),Object(a["createElementVNode"])("h2",null,"file 协议"),Object(a["createElementVNode"])("p",null,"最常见的浏览器访问 h5 页面都是使用 http(s) 协议，包括加载静态文件"),Object(a["createElementVNode"])("p",null,"（截图演示）"),Object(a["createElementVNode"])("p",null,"如果在本地双击一个 html 文件，通过浏览器打开，就是使用 file 协议加载，包括静态文件"),Object(a["createElementVNode"])("p",null,"（截图演示）"),Object(a["createElementVNode"])("p",null,"两者的区别："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"file 协议：本地文件，快"),Object(a["createElementVNode"])("li",null,"http(s) 协议：网络加载，慢")]),Object(a["createElementVNode"])("blockquote",null,[Object(a["createElementVNode"])("p",null,"我们最常用的肯定是 http 或者 https 协议，通过访问 server 端返回网页文件的形式来打开页面。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("但你是否还记得你最开始学习 html 的时候，那会儿还不知道什么是 http 协议，因此你就写完一个 html 页面，直接双击，然后浏览器打开。这会儿看浏览器地址栏，是"),Object(a["createElementVNode"])("code",null,"file:///xxx/xxx/xxx/index.html"),Object(a["createTextVNode"])("这么一种格式。这就是"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("其中的 js css img 文件都可以通过"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议来加载。。。。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("计算机编程的协议有非常多，我们日常接触的有"),Object(a["createElementVNode"])("code",null,"http(s)"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"ftp"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"ws"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"ssh"),Object(a["createTextVNode"])("等。"),Object(a["createElementVNode"])("code",null,"http(s)"),Object(a["createTextVNode"])("是打开一个远程的页面，而"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("是打开一个本地的页面。那两者的区别是啥：")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"http(s)"),Object(a["createTextVNode"])("协议需要通过网络请求，下载页面，然后打开")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议直接打开本地的，断网情况下也能打开，无需网络请求")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从速度上来看，当然是"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议更快")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("一开始提到 hybrid 具有和 NA 一样的体验，其中一点就是和 NA 一样快。如何做到的？—— 就是用了"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("strong",null,[Object(a["createTextVNode"])("hybrid 就是使用"),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议访问本地的 html 页面")]),Object(a["createTextVNode"])("，因此它足够快。所谓“本地”是哪里？—— 每个 app 安装的时候都可以存储一些文件，这些 html 也就放在某一个文件目录下。就像你微信的聊天记录（文字、视频、图片等）都是会存储到系统的某一个地方，app 具有这种存储文件的能力。手机内存如果比较小，如 16g 的 iphone ，你还得定期清理这些垃圾文件。")]),Object(a["createElementVNode"])("h2",null,"具体实现"),Object(a["createElementVNode"])("p",null,"首先，一个 app 不可能所有的地方都使用 hybrid ，这里可以先做一个总结"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"使用 NA ：体验要求极致，变化不频繁（无头条的首页）"),Object(a["createElementVNode"])("li",null,"使用 hybrid ：体验要求高，变化频繁（如头条的新闻详情页）"),Object(a["createElementVNode"])("li",null,"使用 h5 ：体验无要求，不常用（如举报、反馈等页面）")]),Object(a["createElementVNode"])("p",null,"如果一个 app 中某些场景使用 hybrid ，结合上述的 file 协议和 webview ，需要如下做法："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"前端做好静态页面（html js css），将文件交给客户端"),Object(a["createElementVNode"])("li",null,"客户端拿到前端静态页面，以文件形式存储在 app 中"),Object(a["createElementVNode"])("li",null,"客户端在一个 webview 中"),Object(a["createElementVNode"])("li",null,"使用 file 协议加载静态页面")]),Object(a["createElementVNode"])("p",null,"（画图说明）"),Object(a["createElementVNode"])("p",null,"那现在还剩下两件事没处理（后面课程会讲述）："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"app 发布之后，静态文件如何实时更新"),Object(a["createElementVNode"])("li",null,"静态页面如何获取内容（不能用 ajax ，要客户端获取，然后与前端通讯）")]),Object(a["createElementVNode"])("h2",null,"问题解答"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"hybrid 是客户端和前端混合开发"),Object(a["createElementVNode"])("li",null,"hybrid 依赖于客户端（webview file 协议）"),Object(a["createElementVNode"])("li",null,"hybrid 存在的核心价值：更新快")]),Object(a["createElementVNode"])("h1",null,"通信的几种方式"),Object(a["createElementVNode"])("p",null,"js 和客户端交互有很多种方式，基本原理都是 js 去触发某一种操作，客户端能监听到这种操作，从而将 js 需要的信息传递给客户端。"),Object(a["createElementVNode"])("p",null,"客户端处理完毕之后，会执行 js 传入的一个函数，作为 callback ，这一点跟 jsonp 基本一致。"),Object(a["createElementVNode"])("h2",null,"jsbridge"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("就是 webview 在初始化页面的时候，会执行一段 JS 代码，这段代码给"),Object(a["createElementVNode"])("code",null,"window"),Object(a["createTextVNode"])("设置一个全局的函数，例如"),Object(a["createElementVNode"])("code",null,"window.jsbridge"),Object(a["createTextVNode"])("。然后，js 想要执行客户端的什么操作，直接执行这个函数即可。—— 当然，这得提前和客户端约定好，否则你传递的参数客户端不认识。")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 定义全局的回调函数"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])("] = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"result"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"errno"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'分享成功'"),Object(a["createTextVNode"])(")\n    } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 分享失败"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("(result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"message"),Object(a["createTextVNode"])(")\n    }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"jsbridge"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'share'"),Object(a["createTextVNode"])(", {"),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"title"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"content"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])("}, "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])(")\n")])]),Object(a["createElementVNode"])("h2",null,"劫持 prompt"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"window.prompt"),Object(a["createTextVNode"])("默认情况下是一个弹出框，这个大家都知道，这本身是 webview 的一个默认功能。但是 webview 是属于 app 的，app 当然也可以改造 webview ，去重写"),Object(a["createElementVNode"])("code",null,"window.prompt"),Object(a["createTextVNode"])("。重写之后，"),Object(a["createElementVNode"])("code",null,"window.prompt"),Object(a["createTextVNode"])("再没有了默认的功能，调用的时候什么都不会发生，但是能被客户端监听到。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("因此 js 就可以这样和客户端通信（注意，"),Object(a["createElementVNode"])("code",null,"window.prompt"),Object(a["createTextVNode"])("只能接受字符串类型的参数）")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 定义全局的回调函数"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])("] = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"result"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"errno"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'分享成功'"),Object(a["createTextVNode"])(")\n    } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 分享失败"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("(result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"message"),Object(a["createTextVNode"])(")\n    }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" dataStr = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"JSON"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"stringify"),Object(a["createTextVNode"])("({\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'share'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": {"),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"title"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"content"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])("},\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"callback"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])("\n})\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"prompt"),Object(a["createTextVNode"])("(dataStr)\n")])]),Object(a["createElementVNode"])("h2",null,"schema 协议"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("schema 协议类似于"),Object(a["createElementVNode"])("code",null,"http"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"file"),Object(a["createTextVNode"])("协议，例如"),Object(a["createElementVNode"])("code",null,"weixin://dl/scan"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"weixin://dl/profile"),Object(a["createTextVNode"])(" 。无论是 ios 还是安卓，都允许 app 向系统注册 schema 协议，并监听这个协议对应的功能。具体的细节我们不必太关注。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("当 h5 页面发出一个 schema 协议的请求的时候，如"),Object(a["createElementVNode"])("code",null,'<a href="weixin://dl/scan">扫一扫</a>'),Object(a["createTextVNode"])("，app 会监听到这个请求，并且执行相应的功能。这就类似于"),Object(a["createElementVNode"])("code",null,'<a href="mailto:xxx@imooc.com">发邮件</a>'),Object(a["createTextVNode"])("能调起邮箱功能一样。")]),Object(a["createElementVNode"])("p",null,"从网上搜到一些微信的 schema 协议，仅供参考。（我也不在腾讯工作，不清楚微信是否真有这些协议）"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":""},"weixin://dl/scan 扫一扫\nweixin://dl/feedback 反馈\nweixin://dl/moments 朋友圈\nweixin://dl/settings 设置\nweixin://dl/notifications 消息通知设置\nweixin://dl/chat 聊天设置\nweixin://dl/general 通用设置\nweixin://dl/officialaccounts 公众号\nweixin://dl/games 游戏\nweixin://dl/help 帮助\nweixin://dl/profile 个人信息\nweixin://dl/features 功能插件\n")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("简单写一个例子，试用 schema 协议来调起分享面板，加入我们定义的 schema 协议是"),Object(a["createElementVNode"])("code",null,"myapp://utils/share?data=xxx&callback=xxx")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 调用函数"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"action, data, callbackName"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 拼接 schema 协议"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" schema = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'myapp://utils'"),Object(a["createTextVNode"])("\n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/'"),Object(a["createTextVNode"])(" + action\n\n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'?a=a'"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" key\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"for"),Object(a["createTextVNode"])(" (key "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"in"),Object(a["createTextVNode"])(" data) {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"hasOwnProperty"),Object(a["createTextVNode"])("(key)) {\n            schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'&'"),Object(a["createTextVNode"])(" + key + "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'='"),Object(a["createTextVNode"])(" + data[key]\n        }\n    }\n    \n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'&callback='"),Object(a["createTextVNode"])(" + callbackName\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 用 iframe ，如果调用不成功，没有任何副作用"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"createElement"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'iframe'"),Object(a["createTextVNode"])(");\n    iframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"style"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"display"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'none'"),Object(a["createTextVNode"])(";\n    iframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"src"),Object(a["createTextVNode"])(" = schema;\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" body = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"body"),Object(a["createTextVNode"])(" || "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getElementsByTagName"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'body'"),Object(a["createTextVNode"])(")["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])("];\n    body."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"appendChild"),Object(a["createTextVNode"])("(iframe);\n    "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"setTimeout"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        body."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"removeChild"),Object(a["createTextVNode"])("(iframe);\n        iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(";\n    }, "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(");\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 定义全局的回调函数"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])("] = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"result"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"errno"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'分享成功'"),Object(a["createTextVNode"])(")\n    } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 分享失败"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("(result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"message"),Object(a["createTextVNode"])(")\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'share'"),Object(a["createTextVNode"])(", {"),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"title"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"content"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])("}, "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'shareCallback'"),Object(a["createTextVNode"])(")\n")])]),Object(a["createElementVNode"])("h2",null,"最终选择"),Object(a["createElementVNode"])("p",null,"最终选择就是使用 schema 协议。原因:"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("strong",null,"是一个 ios 和安卓都认可的标准。相对而言，以上两种都有点“野路子”"),Object(a["createTextVNode"])("。在计算机程序这个领域，任何违背标准（或者再造标准）的东西都是有很大风险的。例如此前的 IE 低版本，现在的 UC 。如果业界以后基于这个标准去扩展、支持其他东西，你如果不符合标准，那就是毁灭性的灾难。")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("strong",null,"有利于 ios 和安卓双端统一调用方式"),Object(a["createTextVNode"])("。以上两种，可能在 ios 和安卓双端那里并不一定都能试用，这样就导致 ios 和安卓各自玩各自的，双端不统一，对于前端开发人员来说，也是一个灾难性的东西。因为你写的代码得做各种兼容，各种"),Object(a["createElementVNode"])("code",null,"if...else"),Object(a["createTextVNode"])("这是严重违背设计原则的事情。")])]),Object(a["createElementVNode"])("h1",null,"与客户端通讯"),Object(a["createElementVNode"])("h2",null,"新闻详情页如果使用 hybrid ，静态网页如何加载新闻内容？"),Object(a["createElementVNode"])("p",null,"答案：不能用 ajax 加载，而是由客户端加载，然后通过 JS 和客户端的通讯来获取内容"),Object(a["createElementVNode"])("h2",null,"JS 和客户端通讯的基本形式"),Object(a["createElementVNode"])("p",null,"以上面问题举例：JS 访问客户端能力，传递参数和回调函数，客户端通过回调函数返回内容"),Object(a["createElementVNode"])("h2",null,"schema 协议简介和使用"),Object(a["createElementVNode"])("p",null,"本章刚刚介绍了一个 file 协议，这里又要介绍 schema 协议。不过至少你现在已经了解了 http(s) file 协议了，schema 协议也是一样的形式。"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("strong",null,"协议 —— 双方的规定"),Object(a["createTextVNode"])(" 是 JS 和客户端通讯的格式规定，"),Object(a["createElementVNode"])("strong",null,"格式内容都由客户端规定"),Object(a["createTextVNode"])("。例如，这是微信的一些 schema 协议（网上查的）")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":""},"/* 网上搜的微信的部分 schema 协议 */\n\nweixin://dl/scan              扫一扫\nweixin://dl/feedback          反馈\nweixin://dl/moments           朋友圈\nweixin://dl/settings          设置\nweixin://dl/notifications     消息通知设置\nweixin://dl/chat              聊天设置\nweixin://dl/general           通用设置\nweixin://dl/officialaccounts  公众号\nweixin://dl/games             游戏\nweixin://dl/help              帮助\nweixin://dl/profile           个人信息\nweixin://dl/features          功能插件\n")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("简单使用（这个无法在微信中直接用，微信作为这么大一个平台，"),Object(a["createElementVNode"])("strong",null,"客户端通讯有严格的权限验证"),Object(a["createTextVNode"])("，外部页面不能随意访问）")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/* 以下是演示，无法正常运行，微信有严格的权限验证，外部页面不能随意使用 schema */"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"createElement"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'iframe'"),Object(a["createTextVNode"])(");\niframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"style"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"display"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'none'"),Object(a["createTextVNode"])(";\niframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"src"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'weixin://dl/scan'"),Object(a["createTextVNode"])(";  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// iframe 访问 schema"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" body = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"body"),Object(a["createTextVNode"])(" || "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getElementsByTagName"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'body'"),Object(a["createTextVNode"])(")["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])("];\nbody."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"appendChild"),Object(a["createTextVNode"])("(iframe);\n"),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"setTimeout"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    body."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"removeChild"),Object(a["createTextVNode"])("(iframe);  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 销毁 iframe"),Object(a["createTextVNode"])("\n    iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(";\n});\n")])]),Object(a["createElementVNode"])("p",null,"如果要加上参数和 callback ，那么就要这么写"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/* 如果要加上参数和 callback ，那么就要这么写 */"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("["),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'_weixin_scan_callback'"),Object(a["createTextVNode"])("] = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"result"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("(result)\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ...省略..."),Object(a["createTextVNode"])("\niframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"src"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'weixin://dl/scan?k1=v1&k2=v2&k3=v3&callback=_weixin_scan_callback'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ...省略..."),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"schema 的封装"),Object(a["createElementVNode"])("p",null,"底层调用的封装"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"_invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"action, data, callback"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 拼接 schema 协议"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" schema = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'myapp://utils'"),Object(a["createTextVNode"])("\n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/'"),Object(a["createTextVNode"])(" + action\n\n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'?a=a'"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" key\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"for"),Object(a["createTextVNode"])(" (key "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"in"),Object(a["createTextVNode"])(" data) {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"hasOwnProperty"),Object(a["createTextVNode"])("(key)) {\n            schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'&'"),Object(a["createTextVNode"])(" + key + "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'='"),Object(a["createTextVNode"])(" + data[key]\n        }\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 处理 callback"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" callbackName = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"''"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" callback === "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'string'"),Object(a["createTextVNode"])(") {\n        callbackName = callback\n    } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n        callbackName = cation + "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Date"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"now"),Object(a["createTextVNode"])("()\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("[callbackName] = callback\n    }\n\n    schema += "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'&callback='"),Object(a["createTextVNode"])(" + callbackName\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 用 iframe ，如果调用不成功，没有任何副作用"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"createElement"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'iframe'"),Object(a["createTextVNode"])(");\n    iframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"style"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"display"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'none'"),Object(a["createTextVNode"])(";\n    iframe."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"src"),Object(a["createTextVNode"])(" = schema;\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"var"),Object(a["createTextVNode"])(" body = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"body"),Object(a["createTextVNode"])(" || "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"document"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getElementsByTagName"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'body'"),Object(a["createTextVNode"])(")["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])("];\n    body."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"appendChild"),Object(a["createTextVNode"])("(iframe);\n    "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"setTimeout"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        body."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"removeChild"),Object(a["createTextVNode"])("(iframe);\n        iframe = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(";\n    }, "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(");\n}\n")])]),Object(a["createElementVNode"])("p",null,"对每个功能都进行封装，方便调用者使用"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 分享"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"invokeShare"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"data, callback"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"_invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'share'"),Object(a["createTextVNode"])(", data, callback)\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 登录"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"invokeLogin"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"data, callback"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"_invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'login'"),Object(a["createTextVNode"])(", data, callback)\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 打开扫一扫"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"invokeScan"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"data, callback"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"_invoke"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'sacn'"),Object(a["createTextVNode"])(", data, callback)\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 暴露给全局"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"invoke"),Object(a["createTextVNode"])(" = {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"share"),Object(a["createTextVNode"])(": invokeShare,\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"login"),Object(a["createTextVNode"])(": invokeLogin,\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"scan"),Object(a["createTextVNode"])(": invokeScan\n}\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("傻瓜式调用，而且"),Object(a["createElementVNode"])("strong",null,"不用再自己定义全局函数")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/* 傻瓜式调用，而且不用再自己定义全局函数 */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"invoke"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"share"),Object(a["createTextVNode"])("({"),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"title"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"content"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'xxx'"),Object(a["createTextVNode"])("}, "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"result"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"errno"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'分享成功'"),Object(a["createTextVNode"])(")\n    } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 分享失败"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"alert"),Object(a["createTextVNode"])("(result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"message"),Object(a["createTextVNode"])(")\n    }\n})\n")])]),Object(a["createElementVNode"])("h2",null,"内置上线"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("前两部分的代码，封装、打包之后，取名"),Object(a["createElementVNode"])("code",null,"invoke.js"),Object(a["createTextVNode"])("，然后内置到客户端中。客户端打开一个 webview 的时候，就直接执行这个 js 。原因：")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"本地加载，免去网络加载的时间，更快。也没必要每个页面都去加载一遍，各个页面用到的这个 js 都一样的。"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("安全。网络加载很容易被抓包和劫持，这样黑客一解析"),Object(a["createElementVNode"])("code",null,"invoke.js"),Object(a["createTextVNode"])("的代码，就能分析出 app 的 schema 协议的格式。")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},"80bb":function(e,t,c){},"873f":function(e,t,c){"use strict";c.d(t,"b",(function(){return s})),c.d(t,"a",(function(){return o}));var a=c("3835");c("d3b7"),c("ddb0"),c("159b"),c("ac1f"),c("466d"),c("d81d"),c("1276"),c("99af");function l(){var e=c("d3de"),t=e.keys(),a=[];return t&&t.length>0&&t.forEach((function(e){var t=e.match(/\.\/(\S*)\.md/);t&&t[1]&&a.push(t[1])})),a}function n(e){return e.map((function(e,t){var c=e.split("/"),l=Object(a["a"])(c,3),n=l[0],s=l[1],o=l[2];return{id:t+1,url:"/mark-down/".concat(e,".md"),title:o,tag_name:"".concat(n," · ").concat(s||"JavaScript"),type:n}}))}var s="最近在学习js基础",o=n(l())},"8e7c":function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"深拷贝"),Object(a["createElementVNode"])("h2",null,"目标"),Object(a["createElementVNode"])("p",null,"手写 JS 深拷贝"),Object(a["createElementVNode"])("h2",null,"分析"),Object(a["createElementVNode"])("p",null,"这是一个很常见的问题，看似也很简单，但是如果考虑到“高质量代码”的要求，写起来还是挺麻烦的。"),Object(a["createElementVNode"])("h2",null,"错误答案1"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("使用 "),Object(a["createElementVNode"])("code",null,"JSON.stringify"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"JSON.parse")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"无法转换函数"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("无法转换 "),Object(a["createElementVNode"])("code",null,"Map"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"Set")]),Object(a["createElementVNode"])("li",null,"无法转换循环引用")]),Object(a["createElementVNode"])("p",null,"PS：其实普通对象使用 JSON API 的运算速度很快，但功能不全"),Object(a["createElementVNode"])("h2",null,"错误答案2"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("使用 "),Object(a["createElementVNode"])("code",null,"Object.assign"),Object(a["createTextVNode"])(" —— 这根本就不是深拷贝，是浅拷贝 ！！！")]),Object(a["createElementVNode"])("h2",null,"错误答案3"),Object(a["createElementVNode"])("p",null,"只考虑了普通的对象和数组"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("无法转换 "),Object(a["createElementVNode"])("code",null,"Map"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"Set")]),Object(a["createElementVNode"])("li",null,"无法转换循环引用")]),Object(a["createElementVNode"])("h2",null,"正确答案"),Object(a["createElementVNode"])("p",null,"参考代码"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// /**"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//  * 深拷贝 - 只考虑了简单的数组、对象"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//  * @param obj obj"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//  */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// function cloneDeep(obj: any) {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     if (typeof obj !== 'object' || obj == null ) return obj"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     let result: any"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     if (obj instanceof Array) {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         result = []"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     } else {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         result = {}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     for (let key in obj) {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         if (obj.hasOwnProperty(key)) {            "),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//             result[key] = cloneDeep(obj[key]) // 递归调用"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     return result"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const a: any = {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     set: new Set([10, 20, 30]),"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     map: new Map([['x', 10], ['y', 20]])"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// a.self = a"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.log( cloneDeep(a) ) // 无法处理 Map Set 和循环引用"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n * 深拷贝\n * @param obj obj\n * @param map weakmap 为了避免循环引用\n */"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("obj: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", map = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"WeakMap"),Object(a["createTextVNode"])("()")]),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" obj !== "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'object'"),Object(a["createTextVNode"])(" || obj == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(" ) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" obj\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 避免循环引用"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" objFromMap = map."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("(obj)\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (objFromMap) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" objFromMap\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"let"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"target"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(" = {}\n    map."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("(obj, target)\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// Map"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (obj "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])(") {\n        target = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])("()\n        obj."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"v, k"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" v1 = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("(v, map)\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" k1 = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("(k, map)\n            target."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("(k1, v1)\n        })\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// Set"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (obj "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Set"),Object(a["createTextVNode"])(") {\n        target = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Set"),Object(a["createTextVNode"])("()\n        obj."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"forEach"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"v"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" v1 = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("(v, map)\n            target."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"add"),Object(a["createTextVNode"])("(v1)\n        })\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// Array"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (obj "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"instanceof"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Array"),Object(a["createTextVNode"])(") {\n        target = obj."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"map"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"item"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("(item, map))\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// Object"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"for"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" key "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"in"),Object(a["createTextVNode"])(" obj) {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" val = obj[key]\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" val1 = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"cloneDeep"),Object(a["createTextVNode"])("(val, map)\n        target[key] = val1\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" target\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // 功能测试"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const a: any = {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     set: new Set([10, 20, 30]),"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     map: new Map([['x', 10], ['y', 20]]),"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     info: {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         city: '北京'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     },"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     fn: () => { console.info(100) }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// a.self = a"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.log( cloneDeep(a) )"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("hr"),Object(a["createElementVNode"])("p",null,"循环引用 Map Set 函数")])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},a60b:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"微前端"),Object(a["createElementVNode"])("h2",null,"qiankun 的两种应用间通信方式"),Object(a["createElementVNode"])("p",null,"actions 通信及 shared 通信"),Object(a["createElementVNode"])("h2",null,"应该如何划分子应用"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("在开始介绍 "),Object(a["createElementVNode"])("code",null,"qiankun"),Object(a["createTextVNode"])(" 的应用通信之前，我们需要先了解微前端架构如何划分子应用。在微前端架构中，我们应该"),Object(a["createElementVNode"])("strong",null,"按业务划分出对应的子应用"),Object(a["createTextVNode"])("，而"),Object(a["createElementVNode"])("strong",null,"不是通过功能模块划分子应用"),Object(a["createTextVNode"])("。这么做的原因有两个：")]),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,"在微前端架构中，子应用并不是一个模块，而是一个独立的应用，我们将子应用按业务划分可以拥有更好的可维护性和解耦性。"),Object(a["createElementVNode"])("li",null,"子应用应该具备独立运行的能力，应用间频繁的通信会增加应用的复杂度和耦合度。 　　综上所述，我们应该从业务的角度出发划分各个子应用，尽可能减少应用间的通信，从而简化整个应用，使得我们的微前端架构可以更加灵活可控。")]),Object(a["createElementVNode"])("blockquote",null,[Object(a["createElementVNode"])("p",null,"补充一下，上面是理想状态，但是理想状态我们很难达到。微前端最核心的点，是可以做到技术栈无关。比如如果你为了做到技术栈无关，想体验不同的技术，那就无所谓了，直接按模块划分即可，因为单独独立的应用，很多公司遇到这种需求也蛮少。我就是为了实践不同技术栈，所以上了微前端。")]),Object(a["createElementVNode"])("p",null,"本次将介绍两种通信方式："),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("第一种是 "),Object(a["createElementVNode"])("code",null,"qiankun"),Object(a["createTextVNode"])(" 官方提供的通信方式 - "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信，适合业务划分清晰，比较简单的微前端应用，一般来说使用第一种方案就可以满足大部分的应用场景需求。")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("第二种是基于 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])(" 实现的通信方式 - "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信，适合需要跟踪通信状态，子应用具备独立运行能力，较为复杂的微前端应用。")])]),Object(a["createElementVNode"])("h2",null,"Actions 通信"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们先介绍官方提供的应用间通信方式 - "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信，这种通信方式比较适合业务划分清晰，应用间通信较少的微前端应用场景。")]),Object(a["createElementVNode"])("h3",null,"通信原理"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"qiankun"),Object(a["createTextVNode"])(" 内部提供了 "),Object(a["createElementVNode"])("code",null,"initGlobalState"),Object(a["createTextVNode"])(" 方法用于注册 "),Object(a["createElementVNode"])("code",null,"MicroAppStateActions"),Object(a["createTextVNode"])(" 实例用于通信，该实例有三个方法，分别是:")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"setGlobalState：设置 globalState - 设置新的值时，内部将执行 浅检查，如果检查到 globalState 发生改变则触发通知，通知到所有的 观察者 函数。"),Object(a["createElementVNode"])("li",null,"onGlobalStateChange：注册 观察者 函数 - 响应 globalState 变化，在 globalState 发生改变时触发该 观察者 函数。"),Object(a["createElementVNode"])("li",null,"offGlobalStateChange：取消 观察者 函数 - 该实例不再响应 globalState 变化。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们来画一张图来帮助大家理解（见下图） "),Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%A1%86%E6%9E%B6/img/1.png",alt:""}),Object(a["createTextVNode"])(" 我们从上图可以看出，我们可以先注册 观察者 到观察者池中，然后通过修改 "),Object(a["createElementVNode"])("code",null,"globalState"),Object(a["createTextVNode"])(" 可以触发所有的 观察者 函数，从而达到组件间通信的效果。")]),Object(a["createElementVNode"])("h3",null,"通信实例"),Object(a["createElementVNode"])("h4",null,"主应用需要做的工作"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("首先，我们在主应用中注册一个 "),Object(a["createElementVNode"])("code",null,"MicroAppStateActions"),Object(a["createTextVNode"])(" 实例并导出，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-main/src/shared/actions.ts"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" { initGlobalState, "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"MicroAppStateActions"),Object(a["createTextVNode"])(" } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'qiankun'"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" initialState = { "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"status"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'login'"),Object(a["createTextVNode"])(" } "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 全局状态池给了个默认值"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"shareActions"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"MicroAppStateActions"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"initGlobalState"),Object(a["createTextVNode"])("(initialState)\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" shareActions\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("在注册 "),Object(a["createElementVNode"])("code",null,"MicroAppStateActions"),Object(a["createTextVNode"])(" 实例后，我们在需要通信的组件中使用该实例，并注册 "),Object(a["createElementVNode"])("code",null,"观察者"),Object(a["createTextVNode"])(" 函数，我们这里以登录功能为例，实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 1、先引入 actions"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" actions "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'@/shared/actions'"),Object(a["createTextVNode"])("\n@Component\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Login"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"extends"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_ inherited__"},"Vue"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"mounted"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 2、注册一个观察者函数"),Object(a["createTextVNode"])("\n    actions."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"state, prevState"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" {\n      "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'主应用观察者：token 改变前的值为 '"),Object(a["createTextVNode"])(", prevState."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"token"),Object(a["createTextVNode"])(")\n      "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("(\n        "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'主应用观察者：登录状态发生改变，改变后的 token 的值为 '"),Object(a["createTextVNode"])(",\n        state."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"token"),Object(a["createTextVNode"])("\n      )\n    })\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"async"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"login"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 3、触发状态池更新：登录成功后，设置 token"),Object(a["createTextVNode"])("\n    actions."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setGlobalState"),Object(a["createTextVNode"])("({ token })\n  }\n}\n")])]),Object(a["createElementVNode"])("h4",null,"子应用需要做的工作"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们首先来改造我们的 Vue 子应用，首先我们设置一个 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 实例，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-vue/src/shared/actions.js"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"emptyAction"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 警告：提示当前使用的是空 Action"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"warn"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'Current execute action is empty!'"),Object(a["createTextVNode"])(")\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Actions"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 默认值为空 Action"),Object(a["createTextVNode"])("\n  actions = {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"onGlobalStateChange"),Object(a["createTextVNode"])(": emptyAction,\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"setGlobalState"),Object(a["createTextVNode"])(": emptyAction,\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 设置 actions"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setActions"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"actions"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"actions"),Object(a["createTextVNode"])(" = actions\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 映射"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"...args"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"actions"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("(...args)\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 映射"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setGlobalState"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"...args"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"actions"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setGlobalState"),Object(a["createTextVNode"])("(...args)\n  }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" actions = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Actions"),Object(a["createTextVNode"])("()\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" actions\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们创建 "),Object(a["createElementVNode"])("code",null,"actions"),Object(a["createTextVNode"])(" 实例后，我们需要为其注入真实 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])("。我们在入口文件 "),Object(a["createElementVNode"])("code",null,"main.js"),Object(a["createTextVNode"])(" 的 "),Object(a["createElementVNode"])("code",null,"render"),Object(a["createTextVNode"])(" 函数中注入，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-vue/src/main.js"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//..."),Object(a["createTextVNode"])("\n\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"/**\n  * 渲染函数\n  * 主应用生命周期钩子中运行/子应用单独启动时运行\n  */"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"render"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"props"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (props) {\n      "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注入 actions 实例"),Object(a["createTextVNode"])("\n      actions."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setActions"),Object(a["createTextVNode"])("(props);\n    }\n    ......\n  }\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面的代码可以看出，挂载子应用时将会调用 "),Object(a["createElementVNode"])("code",null,"render"),Object(a["createTextVNode"])(" 方法，我们在 "),Object(a["createElementVNode"])("code",null,"render"),Object(a["createTextVNode"])(" 方法中将主应用的 "),Object(a["createElementVNode"])("code",null,"actions"),Object(a["createTextVNode"])(" 实例注入即可。 最后我们在子应用的 通讯页 获取 "),Object(a["createElementVNode"])("code",null,"globalState"),Object(a["createTextVNode"])(" 中的 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("，使用 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 来获取用户信息，最后在页面中显示用户信息。流程伪代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 引入 actions 实例"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" actions "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"@/shared/actions"'),Object(a["createTextVNode"])(";\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" {\n  ......\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"mounted"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注册观察者函数：onGlobalStateChange 第二个参数为 true，表示立即执行一次观察者函数"),Object(a["createTextVNode"])("\n    actions."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"state"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n      "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" { token } = state;\n      "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 未登录 - 返回主页"),Object(a["createTextVNode"])("\n      "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (!token) {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"$message"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"未检测到登录信息！"'),Object(a["createTextVNode"])(");\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"$router"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"/"'),Object(a["createTextVNode"])(");\n      }\n      "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 获取用户信息"),Object(a["createTextVNode"])("\n      "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getUserInfo"),Object(a["createTextVNode"])("(token);\n    }, "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"true"),Object(a["createTextVNode"])(");\n  },\n  ......\n};\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面的代码可以看到，我们在组件挂载时注册了一个 观察者 函数并立即执行，从 "),Object(a["createElementVNode"])("code",null,"globalState/state"),Object(a["createTextVNode"])(" 中获取 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("，然后使用 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 获取用户信息，最终渲染在页面中。")]),Object(a["createElementVNode"])("h3",null,"在项目里实战：在 Nuxt.js 里使用的问题"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("由于在 "),Object(a["createElementVNode"])("code",null,"nuxtjs"),Object(a["createTextVNode"])(" 里服务器不支持浏览器相关的 "),Object(a["createElementVNode"])("code",null,"api"),Object(a["createTextVNode"])("，如 "),Object(a["createElementVNode"])("code",null,"actions"),Object(a["createTextVNode"])(" 的 "),Object(a["createElementVNode"])("code",null,"initGlobalState"),Object(a["createTextVNode"])(" 里却使用了很多浏览器 "),Object(a["createElementVNode"])("code",null,"api"),Object(a["createTextVNode"])("，所以会报错。如何解决呢？ 使用 插件 "),Object(a["createElementVNode"])("code",null,"plugins"),Object(a["createTextVNode"])(" 配合 "),Object(a["createElementVNode"])("code",null,"ssr: false"),Object(a["createTextVNode"])("，使插件在客户端时才加载，这样就可以了。")]),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,"主应用需要做的")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ssr: false 插件里引入"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" shareActions "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'@/utils/shareActions'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注册一个观察者函数"),Object(a["createTextVNode"])("\nshareActions."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"state, prevState"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'主应用观察者：变更前-'"),Object(a["createTextVNode"])(", state, "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'，变更后-'"),Object(a["createTextVNode"])(", prevState)\n})\n"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Vue"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"$actions"),Object(a["createTextVNode"])(" = shareActions\n")])]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 在需要使用的地方直接这样操作即可"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"$actions"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setGlobalState"),Object(a["createTextVNode"])("({ "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"logStatus"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'logout'"),Object(a["createTextVNode"])(" })\n")])]),Object(a["createElementVNode"])("ol",{start:"2"},[Object(a["createElementVNode"])("li",null,"子应用对应业务")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 子应用里直接注册监听函数，然后做对应业务即可"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"async"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"mount"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("props: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.log('[vue] props from main framework', props)"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"render"),Object(a["createTextVNode"])("()\n  props?."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"onGlobalStateChange"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("state: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(" {\n    state?."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"logStatus"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'logout'"),Object(a["createTextVNode"])(" && store."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"commit"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'clearToken'"),Object(a["createTextVNode"])(")\n  }, "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"true"),Object(a["createTextVNode"])(")\n}\n")])]),Object(a["createElementVNode"])("h3",null,"小结"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("到这里，"),Object(a["createElementVNode"])("code",null,"qiankun"),Object(a["createTextVNode"])(" 基础通信 就完成了！我们在主应用中实现了登录功能，登录拿到 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 后存入 "),Object(a["createElementVNode"])("code",null,"globalState"),Object(a["createTextVNode"])(" 状态池中。在进入子应用时，我们使用 "),Object(a["createElementVNode"])("code",null,"actions"),Object(a["createTextVNode"])(" 获取 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("，再使用 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 获取到用户信息，完成页面数据渲染！")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("最后我们画一张图帮助大家理解这个流程（见下图）： "),Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%A1%86%E6%9E%B6/img/2.png",alt:""})]),Object(a["createElementVNode"])("h2",null,"Shared 通信"),Object(a["createElementVNode"])("blockquote",null,[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("由于 "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 方案实现起来会较为复杂，所以当 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信方案满足需求时，使用 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信方案可以得到更好的官方支持。")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("官方提供的 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信方案是通过全局状态池和观察者函数进行应用间通信，该通信方式适合大部分的场景。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 通信方案也存在一些优缺点，优点如下：")]),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,"使用简单；"),Object(a["createElementVNode"])("li",null,"官方支持性高；"),Object(a["createElementVNode"])("li",null,"适合通信较少的业务场景；")]),Object(a["createElementVNode"])("p",null,"缺点如下："),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用独立运行时，需要额外配置无 "),Object(a["createElementVNode"])("code",null,"Actions"),Object(a["createTextVNode"])(" 时的逻辑；")]),Object(a["createElementVNode"])("li",null,"子应用需要先了解状态池的细节，再进行通信；"),Object(a["createElementVNode"])("li",null,"由于状态池无法跟踪，通信场景较多时，容易出现状态混乱、维护困难等问题；")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("如果你的应用通信场景较多，希望子应用具备完全独立运行能力，希望主应用能够更好的管理子应用，那么可以考虑 "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案。")]),Object(a["createElementVNode"])("h3",null,"通信原理"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案的原理就是，主应用基于 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])(" 维护一个状态池，通过 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例暴露一些方法给子应用使用。同时，子应用需要单独维护一份 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，在独立运行时使用自身的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，在嵌入主应用时使用主应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，这样就可以保证在使用和表现上的一致性。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案需要自行维护状态池，这样会增加项目的复杂度。好处是可以使用市面上比较成熟的状态管理工具，如 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])("、"),Object(a["createElementVNode"])("code",null,"mobx"),Object(a["createTextVNode"])("，可以有更好的状态管理追踪和一些工具集。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案要求父子应用都各自维护一份属于自己的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，同样会增加项目的复杂度。好处是子应用可以完全独立于父应用运行（不依赖状态池），子应用也能以最小的改动被嵌入到其他 第三方应用 中。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案也可以帮助主应用更好的管控子应用。子应用只可以通过 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例来操作状态池，可以避免子应用对状态池随意操作引发的一系列问题。主应用的 "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 相对于子应用来说是一个黑箱，子应用只需要了解 "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 所暴露的 "),Object(a["createElementVNode"])("code",null,"API"),Object(a["createTextVNode"])(" 而无需关心实现细节。")]),Object(a["createElementVNode"])("blockquote",null,[Object(a["createElementVNode"])("p",null,"个人总结一下："),Object(a["createElementVNode"])("ol",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("比如我们主应用使用现有 "),Object(a["createElementVNode"])("code",null,"vuex"),Object(a["createTextVNode"])(" 状态管理，然后再提供一个 shared 实例暴露一些 api 来操作其 "),Object(a["createElementVNode"])("code",null,"vuex"),Object(a["createTextVNode"])("，再把 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例通过 "),Object(a["createElementVNode"])("code",null,"props"),Object(a["createTextVNode"])(" 传给子应用；")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用使用现有 vuex 状态管理，子应用也实现自己的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("；然后在入口文件处如果主应用有传 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，则使用主应用实例，没有（即独立运行时）则使用子应用自己的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例。")])])]),Object(a["createElementVNode"])("h3",null,"通信实例"),Object(a["createElementVNode"])("h4",null,"主应用的工作"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("首先我们需要在主应用中创建 "),Object(a["createElementVNode"])("code",null,"store"),Object(a["createTextVNode"])(" 用于管理全局状态池，这里我们使用 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])(" 来实现，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-main/src/shared/store.ts"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" { createStore } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'redux'"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"State"),Object(a["createTextVNode"])(" = {\n  token?: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"type"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Action"),Object(a["createTextVNode"])(" = {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"payload"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" reducer = ("),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"state"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"State"),Object(a["createTextVNode"])(" = {}, "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"action"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Action"),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createElementVNode"])("span",{class:"hljs-params"},"State"),Object(a["createTextVNode"])(" =>")]),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"switch"),Object(a["createTextVNode"])(" (action."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"type"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"default"),Object(a["createTextVNode"])(":\n      "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" state\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 设置 Token"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"case"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'SET_TOKEN'"),Object(a["createTextVNode"])(":\n      "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" {\n        ...state,\n        "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"token"),Object(a["createTextVNode"])(": action."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"payload"),Object(a["createTextVNode"])(",\n      }\n  }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" store = createStore<"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"State"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Action"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"unknown"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"unknown"),Object(a["createTextVNode"])(">(reducer)\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" store\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面可以看出，我们使用 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])(" 创建了一个全局状态池，并设置了一个 "),Object(a["createElementVNode"])("code",null,"reducer"),Object(a["createTextVNode"])(" 用于修改 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 的值。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("接下来我们需要实现主应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-main/src/shared/index.ts"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" store "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'./store'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Shared"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 获取 Token"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"public"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getToken"),Object(a["createTextVNode"])("(): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" state = store."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getState"),Object(a["createTextVNode"])("()\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" state."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"token"),Object(a["createTextVNode"])(" || "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"''"),Object(a["createTextVNode"])("\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 设置 Token"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"public"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setToken"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"token"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"void"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 将 token 的值记录在 store 中"),Object(a["createTextVNode"])("\n    store."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"dispatch"),Object(a["createTextVNode"])("({\n      "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"type"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'SET_TOKEN'"),Object(a["createTextVNode"])(",\n      "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"payload"),Object(a["createTextVNode"])(": token,\n    })\n  }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" shared = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Shared"),Object(a["createTextVNode"])("()\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" shared\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面实现可以看出，我们的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实现非常简单，"),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例包括两个方法 "),Object(a["createElementVNode"])("code",null,"getToken"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"setToken"),Object(a["createTextVNode"])(" 分别用于获取 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 和设置 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("。接下来我们还需要对我们的 登录组件 进行改造，将 "),Object(a["createElementVNode"])("code",null,"login"),Object(a["createTextVNode"])(" 方法修改一下，修改如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-main/src/pages/login/index.vue"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ..."),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"async"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"login"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// ApiLoginQuickly 是一个远程登录函数，用于获取 token，详见 Demo"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" result = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"await"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"ApiLoginQuickly"),Object(a["createTextVNode"])("();\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" { token } = result."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"loginQuickly"),Object(a["createTextVNode"])(";\n\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 使用 shared 的 setToken 方法记录 token"),Object(a["createTextVNode"])("\n  shared."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setToken"),Object(a["createTextVNode"])("(token);\n  "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"$router"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},'"/"'),Object(a["createTextVNode"])(");\n}\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面可以看出，在登录成功后，我们将通过 "),Object(a["createElementVNode"])("code",null,"shared.setToken"),Object(a["createTextVNode"])(" 方法进行业务处理将 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])(" 记录在 "),Object(a["createElementVNode"])("code",null,"store"),Object(a["createTextVNode"])(" 中。")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("最后，我们需要将 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例通过 "),Object(a["createElementVNode"])("code",null,"props"),Object(a["createTextVNode"])(" 传递给子应用，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-main/src/micro/apps.ts"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(" shared "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'@/shared'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" apps = [\n  {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"name"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'ReactMicroApp'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"entry"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'//localhost:10100'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"container"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'#frame'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"activeRule"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/react'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 通过 props 将 shared 传递给子应用"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"props"),Object(a["createTextVNode"])(": { shared },\n  },\n  {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"name"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'VueMicroApp'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"entry"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'//localhost:10200'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"container"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'#frame'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"activeRule"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/vue'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 通过 props 将 shared 传递给子应用"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"props"),Object(a["createTextVNode"])(": { shared },\n  },\n]\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" apps\n")])]),Object(a["createElementVNode"])("h4",null,"子应用的工作"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("现在，我们来处理子应用需要做的工作。我们刚才提到，我们希望子应用有独立运行的能力，所以子应用也应该实现 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("，以便在独立运行时可以拥有兼容处理能力。代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-vue/src/shared/index.js"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Shared"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 获取 Token"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getToken"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 子应用独立运行时，在 localStorage 中获取 token"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"localStorage"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getItem"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'token'"),Object(a["createTextVNode"])(") || "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"''"),Object(a["createTextVNode"])("\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 设置 Token"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setToken"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"token"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 子应用独立运行时，在 localStorage 中设置 token"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"localStorage"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"setItem"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'token'"),Object(a["createTextVNode"])(", token)\n  }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"static"),Object(a["createTextVNode"])(" shared = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Shared"),Object(a["createTextVNode"])("()\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 重载 shared"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"static"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"overloadShared"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"shared"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"shared"),Object(a["createTextVNode"])(" = shared\n  }\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 获取 shared 实例"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"static"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getShared"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"shared"),Object(a["createTextVNode"])("\n  }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("p",null,"从上面我们可以看到两个类，我们来分析一下其用处："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])("：子应用自身的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("，子应用独立运行时将使用该 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("，子应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 使用 "),Object(a["createElementVNode"])("code",null,"localStorage"),Object(a["createTextVNode"])(" 来操作 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("；")]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("code",null,"SharedModule"),Object(a["createTextVNode"])("：用于管理 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("，例如重载 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例、获取 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例等等；")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们实现了子应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 后，我们需要在入口文件处注入 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// micro-app-vue/src/main.js"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 渲染函数：主应用生命周期钩子中运行/子应用单独启动时运行"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"render"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"props = {}"),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 当传入的 shared 为空时，使用子应用自身的 shared"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 当传入的 shared 不为空时，主应用传入的 shared 将会重载子应用的 shared"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" { shared = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getShared"),Object(a["createTextVNode"])("() } = props\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"overloadShared"),Object(a["createTextVNode"])("(shared)\n\n  router = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"VueRouter"),Object(a["createTextVNode"])("({\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"base"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"window"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"__POWERED_BY_QIANKUN__"),Object(a["createTextVNode"])(" ? "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/vue'"),Object(a["createTextVNode"])(" : "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'/'"),Object(a["createTextVNode"])(",\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"mode"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'history'"),Object(a["createTextVNode"])(",\n    routes,\n  })\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 挂载应用"),Object(a["createTextVNode"])("\n  instance = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Vue"),Object(a["createTextVNode"])("({\n    router,\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"render"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-function"},[Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"h"),Object(a["createTextVNode"])(") =>")]),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"h"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"App"),Object(a["createTextVNode"])("),\n  }).$mount("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'#app'"),Object(a["createTextVNode"])(")\n}\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("从上面可以看出，我们在 "),Object(a["createElementVNode"])("code",null,"props"),Object(a["createTextVNode"])(" 的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 字段不为空时，将会使用传入的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 重载子应用自身的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])("。这样做的话，主应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 和子应用的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 在使用时的表现是一致的。 然后我们修改子应用的 通讯页，使用 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例获取 "),Object(a["createElementVNode"])("code",null,"token"),Object(a["createTextVNode"])("，代码实现如下：")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 引入 SharedModule"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"import"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"from"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'@/shared'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(" {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"mounted"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" shared = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"SharedModule"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getShared"),Object(a["createTextVNode"])("()\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 使用 shared 获取 token"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" token = shared."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getToken"),Object(a["createTextVNode"])("()\n  },\n}\n")])]),Object(a["createElementVNode"])("h3",null,"小结"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("我们从上面的案例也可以看出 "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方案的优缺点，这里也做一些简单的分析:")]),Object(a["createElementVNode"])("p",null,"优点有这些："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("可以自由选择状态管理库，更好的开发体验。 - 比如 "),Object(a["createElementVNode"])("code",null,"redux"),Object(a["createTextVNode"])(" 有专门配套的开发工具可以跟踪状态的变化。")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用无需了解主应用的状态池实现细节，只需要了解 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 的函数抽象，实现一套自身的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 甚至空 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 即可，可以更好的规范子应用开发。")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用无法随意污染主应用的状态池，只能通过主应用暴露的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例的特定方法操作状态池，从而避免状态池污染产生的问题。")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用将具备独立运行的能力，"),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信使得父子应用有了更好的解耦性。")])]),Object(a["createElementVNode"])("p",null,"缺点也有两个："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"主应用需要单独维护一套状态池，会增加维护成本和项目复杂度；"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用需要单独维护一份 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例，会增加维护成本； "),Object(a["createElementVNode"])("code",null,"Shared"),Object(a["createTextVNode"])(" 通信方式也是有利有弊，更高的维护成本带来的是应用的健壮性和可维护性。")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("最后我们来画一张图对 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 通信的原理和流程进行解析（见下图）： "),Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%A1%86%E6%9E%B6/img/3.png",alt:""})]),Object(a["createElementVNode"])("p",null,"个人总结一下实践应用的几个步骤："),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("主应用：自身 "),Object(a["createElementVNode"])("code",null,"store（vuex）"),Object(a["createTextVNode"])("状态管理 —— 创建 shared 实例 对 "),Object(a["createElementVNode"])("code",null,"store"),Object(a["createTextVNode"])(" 进行部分 "),Object(a["createElementVNode"])("code",null,"api"),Object(a["createTextVNode"])(" 管理 —— 在使用的时候引入 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例触发对 "),Object(a["createElementVNode"])("code",null,"vuex"),Object(a["createTextVNode"])(" 状态的 "),Object(a["createElementVNode"])("code",null,"api"),Object(a["createTextVNode"])(" 管理 —— 将 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例通过 "),Object(a["createElementVNode"])("code",null,"props"),Object(a["createTextVNode"])(" 传给子应用。")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("子应用：自身 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例、自身 "),Object(a["createElementVNode"])("code",null,"sharedModule"),Object(a["createTextVNode"])(" 管理 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例 —— 在入口处，主应用有传 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例则使用主应用 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例覆载自身的实例；若未传（即独立运行）则使用自身的 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例 —— 在使用的时候引入 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例触发 "),Object(a["createElementVNode"])("code",null,"api"),Object(a["createTextVNode"])(" 管理")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("这样的话子应用也可以有自己的 "),Object(a["createElementVNode"])("code",null,"store"),Object(a["createTextVNode"])(" 状态管理，若想保证自己的状态管理和主应用的状态管理一直，则再触发 "),Object(a["createElementVNode"])("code",null,"vuex"),Object(a["createTextVNode"])(" 更新的时候，调用 "),Object(a["createElementVNode"])("code",null,"shared"),Object(a["createTextVNode"])(" 实例触发主应用 "),Object(a["createElementVNode"])("code",null,"vuex"),Object(a["createTextVNode"])(" 更新即可。")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("到这里，两种 "),Object(a["createElementVNode"])("code",null,"qiankun"),Object(a["createTextVNode"])(" 应用间通信方案就分享完啦！两种通信方案都有合适的使用场景，大家可以结合自己的需要选择即可。")]),Object(a["createElementVNode"])("blockquote",null,[Object(a["createElementVNode"])("p",null,"来自于这篇文章的学习及在项目中的实战使用： 《基于 qiankun 的微前端最佳实践 - 应用间通信篇 - https://juejin.cn/post/6844904151231496200》")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},a623:function(e,t,c){"use strict";c("53f6")},afbc:function(e,t,c){"use strict";(function(e){c("d3b7"),c("3ca3"),c("ddb0");var a=c("6c02"),l=[{path:"/",name:"home",component:function(){return Promise.all([c.e("chunk-libs"),c.e("chunk-30779b1a")]).then(c.bind(null,"65117"))},meta:{keepAlive:!0}},{path:"/article/:articleId",name:"article_detail",component:function(){return Promise.all([c.e("chunk-libs"),c.e("chunk-7915fb20")]).then(c.bind(null,"1000"))},meta:{keepAlive:!0}},{path:"/404",name:"NotFound",component:function(){return c.e("chunk-2d0e95df").then(c.bind(null,"8cdb"))}},{path:"/:pathMatch(.*)*",redirect:"/404",component:function(){return c.e("chunk-2d0e95df").then(c.bind(null,"8cdb"))}}],n=Object(a["a"])({history:Object(a["b"])(e.env.BASE_URL),routes:l});t["a"]=n}).call(this,c("4362"))},bdac:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写 new"),Object(a["createElementVNode"])("h2",null,"题目"),Object(a["createElementVNode"])("p",null,"new 一个对象内部发生了什么，手写代码表示"),Object(a["createElementVNode"])("h2",null,"class 是语法糖"),Object(a["createElementVNode"])("p",null,"ES6 使用 class 代替了 ES6 的构造函数"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Foo"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"name"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])(" = name\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"city"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'北京'"),Object(a["createTextVNode"])("\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"getName"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])("\n    }\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" f = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Foo"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'张三'"),Object(a["createTextVNode"])(")\n")])]),Object(a["createElementVNode"])("p",null,"其实 class 就是一个语法糖，它本质上和构造函数是一样的"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"Foo"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"name"),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])(" = name\n    "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"city"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'北京'"),Object(a["createTextVNode"])("\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Foo"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"getName"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") { "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 注意，这里不可以用箭头函数"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])("\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" f = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Foo"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'张三'"),Object(a["createTextVNode"])(")\n")])]),Object(a["createElementVNode"])("h2",null,"new 一个对象的过程"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"创建一个空对象 obj，继承构造函数的原型"),Object(a["createElementVNode"])("li",null,"执行构造函数（将 obj 作为 this）"),Object(a["createElementVNode"])("li",null,"返回 obj")]),Object(a["createElementVNode"])("h2",null,"实现 new"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" customNew<T>("),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"constructor"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])(", ..."),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"args"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]): T {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 1. 创建一个空对象，继承 constructor 的原型"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" obj = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"create"),Object(a["createTextVNode"])("(constructor."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])(")\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 2. 将 obj 作为 this ，执行 constructor ，传入参数"),Object(a["createTextVNode"])("\n    constructor."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"apply"),Object(a["createTextVNode"])("(obj, args)\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 3. 返回 obj"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" obj\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// class Foo {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     // 属性"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     name: string"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     city: string"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     n: number"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     constructor(name: string, n: number) {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         this.name = name"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         this.city = '北京'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         this.n = n"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     }"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     getName() {"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//         return this.name"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"//     }"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// }"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const f = new Foo('张三', 100)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// // const f = customNew<Foo>(Foo, '张三', 100)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(f)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(f.getName())"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"面试连环问：Object.create 和 {} 的区别"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"Object.create"),Object(a["createTextVNode"])(" 可以指定原型，创建一个空对象。"),Object(a["createElementVNode"])("br"),Object(a["createElementVNode"])("code",null,"{}"),Object(a["createTextVNode"])(" 就相当于 "),Object(a["createElementVNode"])("code",null,"Object.create(Object.prototype)"),Object(a["createTextVNode"])(" ，即根据 "),Object(a["createElementVNode"])("code",null,"Object"),Object(a["createTextVNode"])(" 原型的空对象。")]),Object(a["createElementVNode"])("p",null,"PS：对 JS 原型和原型链还不了解的需要抓紧恶补。")])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},c680:function(e,t,c){},c982:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写 LRU"),Object(a["createElementVNode"])("h3",null,"用 JS 实现一个 LRU 缓存"),Object(a["createElementVNode"])("h2",null,"LRU 使用"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("Least Recently Used 最近最少使用"),Object(a["createElementVNode"])("br"),Object(a["createTextVNode"])(" 即淘汰掉最近最少使用的数据，只保留最近经常使用的资源。它是一个固定容量的缓存容器。")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" lruCache = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LRUCache"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])("); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 最大缓存长度 2"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])("); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 缓存是 {1=1}"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])("); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 缓存是 {1=1, 2=2}"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(");    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 返回 1"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])("); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 该操作会使得关键字 2 作废，缓存是 {1=1, 3=3}"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(");    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 返回 null"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"4"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"4"),Object(a["createTextVNode"])("); "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 该操作会使得关键字 1 作废，缓存是 {4=4, 3=3}"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(");    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 返回 null"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(");    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 返回 3"),Object(a["createTextVNode"])("\nlruCache."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"4"),Object(a["createTextVNode"])(");    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 返回 4"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"分析"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("哈希表，即 "),Object(a["createElementVNode"])("code",null,"{ k1: v1, k2: v2, ... }"),Object(a["createTextVNode"])(" 形式。可以 "),Object(a["createElementVNode"])("code",null,"O(1)"),Object(a["createTextVNode"])(" 事件复杂度存取 "),Object(a["createElementVNode"])("code",null,"key"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"value")]),Object(a["createElementVNode"])("li",null,"有序。可以根据最近使用情况清理缓存")]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("JS 内置的数据结构类型 "),Object(a["createElementVNode"])("code",null,"Object"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"Array"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"Set"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"Map"),Object(a["createTextVNode"])(" ，恰好 "),Object(a["createElementVNode"])("code",null,"Map"),Object(a["createTextVNode"])(" 符合这两条要求")]),Object(a["createElementVNode"])("h2",null,"Map 是有序的"),Object(a["createElementVNode"])("p",null,"Map 有序，Object 无序"),Object(a["createElementVNode"])("h2",null,"实现"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LRUCache"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"length"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])("<"),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("> = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Map"),Object(a["createTextVNode"])("()\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("length: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (length < "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"throw"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'invalid length'"),Object(a["createTextVNode"])(")\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" = length\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("key: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", value: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"has"),Object(a["createTextVNode"])("(key)) {\n            data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"delete"),Object(a["createTextVNode"])("(key)\n        }\n        data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("(key, value)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (data."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"size"),Object(a["createTextVNode"])(" > "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(") {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 如果超出了容量，则删除 Map 最老的元素"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" delKey = data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"keys"),Object(a["createTextVNode"])("()."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"next"),Object(a["createTextVNode"])("()."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"value"),Object(a["createTextVNode"])("\n            data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"delete"),Object(a["createTextVNode"])("(delKey)\n        }\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (!data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"has"),Object(a["createTextVNode"])("(key)) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" value = data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("(key)\n\n        data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"delete"),Object(a["createTextVNode"])("(key)\n        data."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("(key, value)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" value\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const lruCache = new LRUCache(2)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set(1, 1) // {1=1}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set(2, 2) // {1=1, 2=2}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get(1)) // 1 {2=2, 1=1}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set(3, 3) // {1=1, 3=3}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get(2)) // null"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set(4, 4) // {3=3, 4=4}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get(1)) // null"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get(3)) // 3 {4=4, 3=3}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get(4)) // 4 {3=3, 4=4}"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("注意，"),Object(a["createElementVNode"])("code",null,"get"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"set"),Object(a["createTextVNode"])(" 时都要把操作数据移动到 Map 最新的位置。")]),Object(a["createElementVNode"])("h2",null,"扩展"),Object(a["createElementVNode"])("p",null,"实际项目中可以使用第三方 lib"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"https://www.npmjs.com/package/quick-lru"),Object(a["createElementVNode"])("li",null,"https://www.npmjs.com/package/lru-cache"),Object(a["createElementVNode"])("li",null,"https://www.npmjs.com/package/tiny-lru"),Object(a["createElementVNode"])("li",null,"https://www.npmjs.com/package/mnemonist")]),Object(a["createElementVNode"])("h2",null,"连环问：不用 Map 如何实现 LRU cache ？"),Object(a["createElementVNode"])("p",null,"LRU cache 是很早就有的算法，而 Map 仅仅是这几年才加入的 ES 语法。"),Object(a["createElementVNode"])("h3",null,"使用 Object 和 Array"),Object(a["createElementVNode"])("p",null,"根据上文的分析，两个条件"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("哈希表，可以用 "),Object(a["createElementVNode"])("code",null,"Object"),Object(a["createTextVNode"])(" 实现")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("有序，可以用 "),Object(a["createElementVNode"])("code",null,"Array"),Object(a["createTextVNode"])(" 实现")])]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 执行 lru.set('a', 1) lru.set('b', 2) lru.set('c', 3) 后的数据"),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" obj1 = { "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"value"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'a'"),Object(a["createTextVNode"])(" }\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" obj2 = { "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"value"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'b'"),Object(a["createTextVNode"])(" }\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" obj3 = { "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"value"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"3"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'c'"),Object(a["createTextVNode"])(" }\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data = [obj1, obj2, obj3]\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" map = { "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'a'"),Object(a["createTextVNode"])(": obj1, "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'b'"),Object(a["createTextVNode"])(": obj2, "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'c'"),Object(a["createTextVNode"])(": obj3 }\n")])]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("模拟 "),Object(a["createElementVNode"])("code",null,"get"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"set"),Object(a["createTextVNode"])(" 操作，会发现几个问题，都来自于数组")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("超出 cache 容量时，要移除最早的元素，数组 "),Object(a["createElementVNode"])("code",null,"shift"),Object(a["createTextVNode"])(" 效率低")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("每次 "),Object(a["createElementVNode"])("code",null,"get"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"set"),Object(a["createTextVNode"])(" 时都要把当前元素移动到最新的位置，数组 "),Object(a["createElementVNode"])("code",null,"splice"),Object(a["createTextVNode"])(" 效率低")])]),Object(a["createElementVNode"])("h3",null,"Array 改为双向链表"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("数组有问题，就需要使用新的数据结构 "),Object(a["createElementVNode"])("strong",null,"双向链表")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Interface"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"INode"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"value"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("\n    next?: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"INode"),Object(a["createTextVNode"])("\n    prev?: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"INode"),Object(a["createTextVNode"])("\n}\n")])]),Object(a["createElementVNode"])("p",null,"双向链表可以快速移动元素。末尾新增元素 D 很简单，开头删除 A 元素也很简单。"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%89%8B%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/img/%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8-1.png",alt:""})]),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("要把中间的元素 B 移动到最后（如 LRU "),Object(a["createElementVNode"])("code",null,"set"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"get"),Object(a["createTextVNode"])(" 时移动数据位置），只需要修改前后的指针即可，效率很高。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%89%8B%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/img/%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8-2.png",alt:""})]),Object(a["createElementVNode"])("h3",null,"实现"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"interface"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"value"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 存储 key ，方便删除（否则删除时就需要遍历 this.data )"),Object(a["createTextVNode"])("\n    prev?: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])("\n    next?: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])("\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"export"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"default"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LRUCache"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"length"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"data"),Object(a["createTextVNode"])(": { ["),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("]: "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])(" } = {}\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"dataLength"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"0"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"listHead"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])(" | "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"listTail"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])(" | "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])("\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("length: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (length < "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"throw"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'invalid length'"),Object(a["createTextVNode"])(")\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(" = length\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"moveToTail"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"curNode: IListNode"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" tail = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listTail"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (tail === curNode) "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// -------------- 1. 让 prevNode nextNode 断绝与 curNode 的关系 --------------"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" prevNode = curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" nextNode = curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (prevNode) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (nextNode) {\n                prevNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])(" = nextNode\n            } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" prevNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])("\n            }\n        }\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (nextNode) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (prevNode) {\n                nextNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])(" = prevNode\n            } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" nextNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])("\n            }\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listHead"),Object(a["createTextVNode"])(" === curNode) "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listHead"),Object(a["createTextVNode"])(" = nextNode\n        }\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// -------------- 2. 让 curNode 断绝与 prevNode nextNode 的关系 --------------"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// -------------- 3. 在 list 末尾重新建立 curNode 的新关系 --------------"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (tail) {\n            tail."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])(" = curNode\n            curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])(" = tail\n        }\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listTail"),Object(a["createTextVNode"])(" = curNode\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"tryClean"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"while"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"dataLength"),Object(a["createTextVNode"])(" > "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"length"),Object(a["createTextVNode"])(") {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" head = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listHead"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (head == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"throw"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'head is null'"),Object(a["createTextVNode"])(")\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" headNext = head."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (headNext == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"throw"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Error"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'headNext is null'"),Object(a["createTextVNode"])(")\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 1. 断绝 head 和 next 的关系"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" headNext."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"prev"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" head."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"next"),Object(a["createTextVNode"])("\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 2. 重新赋值 listHead"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listHead"),Object(a["createTextVNode"])(" = headNext\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 3. 清理 data ，重新计数"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("[head."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"key"),Object(a["createTextVNode"])("]\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"dataLength"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"dataLength"),Object(a["createTextVNode"])(" - "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])("\n        }\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"get"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"key"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("): "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(" {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" curNode = data[key]\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (curNode == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listTail"),Object(a["createTextVNode"])(" === curNode) {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 本身在末尾（最新鲜的位置），直接返回 value"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"value"),Object(a["createTextVNode"])("\n        }\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// curNode 移动到末尾"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"moveToTail"),Object(a["createTextVNode"])("(curNode)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"value"),Object(a["createTextVNode"])("\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"set"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("key: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])(", value: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" data = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"data"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" curNode = data[key]\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (curNode == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 新增数据"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"newNode"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"IListNode"),Object(a["createTextVNode"])(" = { key, value }\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 移动到末尾"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"moveToTail"),Object(a["createTextVNode"])("(newNode)\n\n            data[key] = newNode\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"dataLength"),Object(a["createTextVNode"])("++\n\n            "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"dataLength"),Object(a["createTextVNode"])(" === "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"listHead"),Object(a["createTextVNode"])(" = newNode\n        } "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"else"),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 修改现有数据"),Object(a["createTextVNode"])("\n            curNode."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"value"),Object(a["createTextVNode"])(" = value\n            "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 移动到末尾"),Object(a["createTextVNode"])("\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"moveToTail"),Object(a["createTextVNode"])("(curNode)\n        }\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 尝试清理长度"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"tryClean"),Object(a["createTextVNode"])("()\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// const lruCache = new LRUCache(2)"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set('1', 1) // {1=1}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set('2', 2) // {1=1, 2=2}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get('1')) // 1 {2=2, 1=1}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set('3', 3) // {1=1, 3=3}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get('2')) // null"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// lruCache.set('4', 4) // {3=3, 4=4}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get('1')) // null"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get('3')) // 3 {4=4, 3=3}"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// console.info(lruCache.get('4')) // 4 {3=3, 4=4}"),Object(a["createTextVNode"])("\n\n")])]),Object(a["createElementVNode"])("p",null,"注意事项"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("数据结构如何定义，"),Object(a["createElementVNode"])("code",null,"data"),Object(a["createTextVNode"])(" 和链表分别存储什么")]),Object(a["createElementVNode"])("li",null,"双向链表的操作（非常繁琐，写代码很容易出错，逻辑一定要清晰！！！）"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("链表 "),Object(a["createElementVNode"])("code",null,"node"),Object(a["createTextVNode"])(" 中要存储 "),Object(a["createElementVNode"])("code",null,"data.key"),Object(a["createTextVNode"])(" ，否则删除 "),Object(a["createElementVNode"])("code",null,"data"),Object(a["createTextVNode"])(" 需要遍历、效率低")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},cd49:function(e,t,c){"use strict";c.r(t);c("e260"),c("e6cf"),c("cca6"),c("a79d");var a=c("7a23"),l=(c("ac1f"),c("00b4"),c("6c02")),n=c("5502"),s=c("873f"),o=function(e){return Object(a["pushScopeId"])("data-v-8d4e7f96"),e=e(),Object(a["popScopeId"])(),e},r={class:"navibar"},j={class:"nav-logo"},d={class:"nav-input"},b=o((function(){return Object(a["createElementVNode"])("svg",{viewBox:"0 0 1024 1024"},[Object(a["createElementVNode"])("path",{fill:"currentColor",d:"M192 413.952V896h640V413.952L512 147.328 192 413.952zM139.52 374.4l352-293.312a32 32 0 0 1 40.96 0l352 293.312A32 32 0 0 1 896 398.976V928a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V398.976a32 32 0 0 1 11.52-24.576z"})],-1)})),O=[b],N=Object(a["defineComponent"])({setup:function(e){var t=Object(l["d"])(),c=Object(l["c"])(),o=Object(n["b"])(),b=/^\/article\/\d+$/,N=function(){o.dispatch("updateArticleId",{id:""}),t.push({path:"/"})},V=function(e){o.dispatch("updateArticleId",{id:e}),e&&(b.test(c.path)?o.dispatch("updateArticleMd",{id:e}):t.push({path:"/article/"+e}))};return function(e,t){var l=Object(a["resolveComponent"])("el-image"),n=Object(a["resolveComponent"])("el-option"),b=Object(a["resolveComponent"])("el-select");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",r,[Object(a["createElementVNode"])("div",j,[Object(a["createVNode"])(l,{src:"https://avatars.githubusercontent.com/u/11586598?v=4"})]),Object(a["createElementVNode"])("div",d,["/"===Object(a["unref"])(c).path?(Object(a["openBlock"])(),Object(a["createBlock"])(b,{key:0,modelValue:Object(a["unref"])(o).state.articleId,"onUpdate:modelValue":t[0]||(t[0]=function(e){return Object(a["unref"])(o).state.articleId=e}),class:"m-2 input",placeholder:"Search or jump to…",size:"small",clearable:"",filterable:"","suffix-icon":"",onChange:V},{default:Object(a["withCtx"])((function(){return[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(Object(a["unref"])(s["a"]),(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(n,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("i",{class:"el-icon home-icom",onClick:t[1]||(t[1]=function(e){return N()})},O)])}}}),V=(c("27d4"),c("d959")),m=c.n(V);const p=m()(N,[["__scopeId","data-v-8d4e7f96"]]);var E=p,h={class:"app-container"},x={class:"my-header"},i={class:"my-main"},T=Object(a["defineComponent"])({setup:function(e){return function(e,t){var c=Object(a["resolveComponent"])("el-affix"),l=Object(a["resolveComponent"])("router-view");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",h,[Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("div",x,[Object(a["createVNode"])(E)])]})),_:1}),Object(a["createElementVNode"])("div",i,[Object(a["createVNode"])(l,null,{default:Object(a["withCtx"])((function(t){var c=t.Component;return[e.$route.meta.keepAlive?(Object(a["openBlock"])(),Object(a["createBlock"])(a["KeepAlive"],{key:0},[(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["resolveDynamicComponent"])(c)))],1024)):(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["resolveDynamicComponent"])(c),{key:1}))]})),_:1})])])}}});c("a623"),c("6f73");const u=T;var f=u,y=c("afbc"),g=c("1da1"),k=(c("96cf"),c("e6b8")),w=Object(n["a"])({state:{articleMd:"",articleId:""},mutations:{UPDATE_ARTICLE_MD:function(e,t){e.articleMd=t.md},UPDATE_ARTICLE_ID:function(e,t){e.articleId=t.id}},actions:{updateArticleMd:function(e,t){return Object(g["a"])(regeneratorRuntime.mark((function c(){var a,l,n;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:if(a=e.commit,l=t.id,!l){c.next=7;break}return c.next=5,Object(k["a"])(l);case 5:n=c.sent,a("UPDATE_ARTICLE_MD",{md:n});case 7:case"end":return c.stop()}}),c)})))()},updateArticleId:function(e,t){var c=e.commit,a=t.id;c("UPDATE_ARTICLE_ID",{id:a})}},modules:{}}),_=c("c3a1"),v=c("c1a0");c("7437");y["a"].beforeEach(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,c,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a();case 1:case"end":return e.stop()}}),e)})));return function(t,c,a){return e.apply(this,arguments)}}());var S=c("ee2d"),A=c.n(S),C=(c("fefe"),c("19b3")),B=c.n(C),M=(c("fd0f"),c("02c6")),L=c.n(M),I=(c("8966"),c("8c7a")),D=c.n(I),F=(c("f393"),c("8009"),c("cb55"),c("6cf3"),c("416b"),c("6605"),c("5c81"),c("6917")),P=c.n(F),R=(c("a955"),c("587d")),U=c.n(R),q=c("059a"),G=c.n(q),J=(c("9a38"),c("07e7")),K=c.n(J),$=(c("41c1"),c("b649")),H=c.n($);A.a.use(L.a,{Prism:D.a,extend:function(e){}}),A.a.use(K()()),A.a.use(P()()),A.a.use(U()()),A.a.use(G()()),A.a.use(H()()),B.a.use(L.a,{Prism:D.a,extend:function(e){}}),B.a.use(K()()),B.a.use(P()()),B.a.use(U()()),B.a.use(G()()),B.a.use(H()());var z=Object(a["createApp"])(f);z.use(w),z.use(y["a"]),z.use(_["a"],{locale:v["a"]}),z.use(A.a),z.use(B.a),z.mount("#app")},d3de:function(e,t,c){var a={"./fe-interview/手写高质量代码/array-flatten.md":"2eb0","./fe-interview/手写高质量代码/curry-add.md":"1aae","./fe-interview/手写高质量代码/dom转vdom.md":"3e8b","./fe-interview/手写高质量代码/手写LRU.md":"c982","./fe-interview/手写高质量代码/手写bind函数.md":"eaf3","./fe-interview/手写高质量代码/手写event-bus.md":"6df7","./fe-interview/手写高质量代码/手写instanceof.md":"696e","./fe-interview/手写高质量代码/手写lazyman.md":"f87f","./fe-interview/手写高质量代码/手写new.md":"bdac","./fe-interview/手写高质量代码/深拷贝.md":"8e7c","./fe-interview/手写高质量代码/类型判断.md":"54af","./fe-interview/手写高质量代码/遍历DOM树.md":"69e2","./fe-interview/框架/微服务通信.md":"a60b","./fe-interview/移动端/h5和客户端.md":"7cb0"};function l(e){var t=n(e);return c(t)}function n(e){if(!c.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}l.keys=function(){return Object.keys(a)},l.resolve=n,e.exports=l,l.id="d3de"},e6b8:function(e,t,c){"use strict";c.d(t,"a",(function(){return r}));var a=c("1da1"),l=(c("96cf"),c("7db0"),c("d3b7"),c("d9e2"),c("bc3a")),n=c.n(l),s=c("873f"),o="https://sunny586.github.io/dist";function r(e){return j.apply(this,arguments)}function j(){return j=Object(a["a"])(regeneratorRuntime.mark((function e(t){var c,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c=s["a"].find((function(e){return e.id===+t})),c){e.next=3;break}return e.abrupt("return",new Error("模板id不存在，请检查"));case 3:return e.next=5,n.a.get(o+c.url);case 5:if(a=e.sent,l=a.data,l){e.next=9;break}throw new Error("根据模板id找不到markdown, 请检查!");case 9:return e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}},eaf3:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写函数 bind"),Object(a["createElementVNode"])("h2",null,"bind 应用"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"返回一个新的函数（旧函数不会更改）"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("绑定 "),Object(a["createElementVNode"])("code",null,"this"),Object(a["createTextVNode"])(" 和部分参数")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("箭头函数，无法改变 "),Object(a["createElementVNode"])("code",null,"this"),Object(a["createTextVNode"])(" ，只能改变参数")])]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b, c"),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(", a, b, c)\n}\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fn1 = fn."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"bind"),Object(a["createTextVNode"])("({ "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"x"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(" })\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn1"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"30"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// {x: 100} 10 20 30"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fn2 = fn."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"bind"),Object(a["createTextVNode"])("({ "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"x"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(" }, "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(")\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn2"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"30"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// {x: 100} 1 2 10 （注意第三个参数变成了 10）"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"30"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// window 10 20 30 （旧函数不变）"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"解答"),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"myBind"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("context: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", ...bindArgs: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// context 是 bind 传入的 this"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// bindArgs 是 bind 传入的各个参数"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" self = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 当前的函数本身"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("...args: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])(") {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 拼接参数"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" newArgs = bindArgs."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"concat"),Object(a["createTextVNode"])("(args)\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" self."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"apply"),Object(a["createTextVNode"])("(context, newArgs)\n  }\n}\n")])]),Object(a["createElementVNode"])("p",null,"要点"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"返回新函数"),Object(a["createElementVNode"])("li",null,"拼接参数（bind 参数 + 执行参数）"),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("重新绑定 "),Object(a["createElementVNode"])("code",null,"this")])]),Object(a["createElementVNode"])("h2",null,"扩展：手写函数 call 和 apply"),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("code",null,"bind"),Object(a["createTextVNode"])(" 生成新函数，暂不执行。而 "),Object(a["createElementVNode"])("code",null,"call"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("code",null,"apply"),Object(a["createTextVNode"])(" 会直接立即执行函数")]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("重新绑定 "),Object(a["createElementVNode"])("code",null,"this"),Object(a["createTextVNode"])(" （箭头函数不支持）")]),Object(a["createElementVNode"])("li",null,"传入参数")]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"fn"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"a, b, c"),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"log"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(", a, b, c)\n}\nfn."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"call"),Object(a["createTextVNode"])("({ "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"x"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(" }, "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"30"),Object(a["createTextVNode"])(")\nfn."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"apply"),Object(a["createTextVNode"])("({ "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"x"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"100"),Object(a["createTextVNode"])(" }, ["),Object(a["createElementVNode"])("span",{class:"hljs-number"},"10"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"20"),Object(a["createTextVNode"])(", "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"30"),Object(a["createTextVNode"])("])\n")])]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"myCall"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("context: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", ...args: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[]")]),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (context == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") context = globalThis\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" context !== "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'object'"),Object(a["createTextVNode"])(") context = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("(context) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 值类型，变为对象"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fnKey = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Symbol"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 不会出现属性名称的覆盖"),Object(a["createTextVNode"])("\n  context[fnKey] = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// this 就是当前的函数"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" res = context[fnKey](...args) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 绑定了 this"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" context[fnKey] "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 清理掉 fn ，防止污染"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n")])]),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"prototype")]),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"myApply"),Object(a["createTextVNode"])(" = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"function"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("context: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])(", args: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"any"),Object(a["createTextVNode"])("[] = []")]),Object(a["createTextVNode"])(") {\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (context == "),Object(a["createElementVNode"])("span",{class:"hljs-literal"},"null"),Object(a["createTextVNode"])(") context = globalThis\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" ("),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"typeof"),Object(a["createTextVNode"])(" context !== "),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'object'"),Object(a["createTextVNode"])(") context = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Object"),Object(a["createTextVNode"])("(context) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 值类型，变为对象"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" fnKey = "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Symbol"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 不会出现属性名称的覆盖"),Object(a["createTextVNode"])("\n  context[fnKey] = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// this 就是当前的函数"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" res = context[fnKey](...args) "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 绑定了 this"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"delete"),Object(a["createTextVNode"])(" context[fnKey] "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 清理掉 fn ，防止污染"),Object(a["createTextVNode"])("\n  "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(" res\n}\n")])]),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("使用 "),Object(a["createElementVNode"])("code",null,"obj.fn"),Object(a["createTextVNode"])(" 执行，即可设置 "),Object(a["createElementVNode"])("code",null,"fn"),Object(a["createTextVNode"])(" 执行时的 "),Object(a["createElementVNode"])("code",null,"this")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("考虑 "),Object(a["createElementVNode"])("code",null,"context"),Object(a["createTextVNode"])(" 各种情况")]),Object(a["createElementVNode"])("li",null,[Object(a["createTextVNode"])("使用 "),Object(a["createElementVNode"])("code",null,"symbol"),Object(a["createTextVNode"])(" 类型扩展属性")])])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d},f87f:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),l=Object(a["createElementVNode"])("html",null,[Object(a["createElementVNode"])("head"),Object(a["createElementVNode"])("body",null,[Object(a["createElementVNode"])("h1",null,"手写 LazyMan"),Object(a["createElementVNode"])("h2",null,[Object(a["createTextVNode"])("实现 "),Object(a["createElementVNode"])("code",null,"sleep"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"eat"),Object(a["createTextVNode"])(" 两个方法，支持链式调用。")]),Object(a["createElementVNode"])("p",null,"代码示例："),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" me = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LazyMan"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'张三'"),Object(a["createTextVNode"])(")\nme."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'苹果'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'香蕉'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"sleep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"5"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'葡萄'"),Object(a["createTextVNode"])(") "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 打印结果如下："),Object(a["createTextVNode"])("\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '张三 eat 苹果'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '张三 eat 香蕉'"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// （等待 5s）"),Object(a["createTextVNode"])("\n"),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// '张三 eat 葡萄'"),Object(a["createTextVNode"])("\n")])]),Object(a["createElementVNode"])("h2",null,"设计 class 框架"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-js"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LazyMan"),Object(a["createTextVNode"])(" {\n    private "),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"name"),Object(a["createTextVNode"])(": string\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"name: string"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])(" = name\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"x: string"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 打印 eat 行为"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 支持链式调用"),Object(a["createTextVNode"])("\n    }\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"sleep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},"seconds: number"),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 等待 10s 的处理逻辑"),Object(a["createTextVNode"])("\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 支持链式调用"),Object(a["createTextVNode"])("\n    }\n}\n")])]),Object(a["createElementVNode"])("h2",null,"处理 sleep 逻辑"),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])("初始化一个任务队列，执行 "),Object(a["createElementVNode"])("code",null,"eat"),Object(a["createTextVNode"])(" 和 "),Object(a["createElementVNode"])("code",null,"sleep"),Object(a["createTextVNode"])(" 是都往队列插入一个函数。依次执行队列的任务，遇到 "),Object(a["createElementVNode"])("code",null,"sleep"),Object(a["createTextVNode"])(" 就延迟触发 "),Object(a["createElementVNode"])("code",null,"next"),Object(a["createTextVNode"])(" 。")]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("img",{src:"https://sunny586.github.io/dist/mark-down/fe-interview/%E6%89%8B%E5%86%99%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/img/sleep.png",alt:""})]),Object(a["createElementVNode"])("p",null,"代码参考"),Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{"v-pre":"",class:"language-ts"},[Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"class"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LazyMan"),Object(a["createTextVNode"])(" {\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"name"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string"),Object(a["createTextVNode"])("\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-attr"},"tasks"),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"Function"),Object(a["createTextVNode"])("[] = [] "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 任务列表"),Object(a["createTextVNode"])("\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"constructor"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("name: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"name"),Object(a["createTextVNode"])(" = name\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"setTimeout"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},"() =>"),Object(a["createTextVNode"])(" {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"next"),Object(a["createTextVNode"])("()\n        })\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"private"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"next"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" task = "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"tasks"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"shift"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 取出当前 tasks 的第一个任务"),Object(a["createTextVNode"])("\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"if"),Object(a["createTextVNode"])(" (task) "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"task"),Object(a["createTextVNode"])("()\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("food: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"string")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"task"),Object(a["createTextVNode"])(" = ("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") => {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},[Object(a["createTextVNode"])("`"),Object(a["createElementVNode"])("span",{class:"hljs-subst"},[Object(a["createTextVNode"])("${"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(".name}")]),Object(a["createTextVNode"])(" eat "),Object(a["createElementVNode"])("span",{class:"hljs-subst"},"${food}"),Object(a["createTextVNode"])("`")]),Object(a["createTextVNode"])(")\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"next"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 立刻执行下一个任务"),Object(a["createTextVNode"])("\n        }\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"tasks"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(task)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 链式调用"),Object(a["createTextVNode"])("\n    }\n\n    "),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"sleep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-params"},[Object(a["createTextVNode"])("seconds: "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"number")]),Object(a["createTextVNode"])(") {\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"task"),Object(a["createTextVNode"])(" = ("),Object(a["createElementVNode"])("span",{class:"hljs-params"}),Object(a["createTextVNode"])(") => {\n            "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},[Object(a["createTextVNode"])("`"),Object(a["createElementVNode"])("span",{class:"hljs-subst"},[Object(a["createTextVNode"])("${"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(".name}")]),Object(a["createTextVNode"])(" 开始睡觉`")]),Object(a["createTextVNode"])(")\n            "),Object(a["createElementVNode"])("span",{class:"hljs-built_in"},"setTimeout"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-function"},"() =>"),Object(a["createTextVNode"])(" {\n                "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"console"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"info"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},[Object(a["createTextVNode"])("`"),Object(a["createElementVNode"])("span",{class:"hljs-subst"},[Object(a["createTextVNode"])("${"),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(".name}")]),Object(a["createTextVNode"])(" 已经睡完了 "),Object(a["createElementVNode"])("span",{class:"hljs-subst"},"${seconds}"),Object(a["createTextVNode"])("s，开始执行下一个任务`")]),Object(a["createTextVNode"])(")\n                "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"next"),Object(a["createTextVNode"])("() "),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// xx 秒之后再执行下一个任务"),Object(a["createTextVNode"])("\n            }, seconds * "),Object(a["createElementVNode"])("span",{class:"hljs-number"},"1000"),Object(a["createTextVNode"])(")\n        }\n        "),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-property"},"tasks"),Object(a["createTextVNode"])("."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"push"),Object(a["createTextVNode"])("(task)\n\n        "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"return"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-variable language_"},"this"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-comment"},"// 链式调用"),Object(a["createTextVNode"])("\n    }\n}\n\n"),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"const"),Object(a["createTextVNode"])(" me = "),Object(a["createElementVNode"])("span",{class:"hljs-keyword"},"new"),Object(a["createTextVNode"])(),Object(a["createElementVNode"])("span",{class:"hljs-title class_"},"LazyMan"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'张三'"),Object(a["createTextVNode"])(")\nme."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'苹果'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'香蕉'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"sleep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'葡萄'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'西瓜'"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"sleep"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-number"},"2"),Object(a["createTextVNode"])(")."),Object(a["createElementVNode"])("span",{class:"hljs-title function_"},"eat"),Object(a["createTextVNode"])("("),Object(a["createElementVNode"])("span",{class:"hljs-string"},"'橘子'"),Object(a["createTextVNode"])(")\n")])]),Object(a["createElementVNode"])("h2",null,"总结"),Object(a["createElementVNode"])("ul",null,[Object(a["createElementVNode"])("li",null,"链式调用"),Object(a["createElementVNode"])("li",null,"任务队列"),Object(a["createElementVNode"])("li",null,"延迟触发")])])],-1),n=[l];function s(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("section",null,n)}var o=c("b9a6"),r=c.n(o);const j={},d=r()(j,[["render",s]]);t["default"]=d}});